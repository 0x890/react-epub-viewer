{"version":3,"sources":["modules/epubViewer/style.ts","modules/epubViewer/EpubViewer.tsx","LoadingView.tsx","lib/utils/commonUtil.ts","modules/reactViewer/viewerStyle.ts","modules/reactViewer/ReactViewer.tsx","lib/styles/palette.ts","lib/styles/zIndex.ts","components/header/Wrapper.tsx","components/header/Layout.tsx","lib/styles/styles.ts","lib/styles/media.ts","components/header/Logo.tsx","components/header/ControlBtn.tsx","containers/Header.tsx","components/footer/Wrapper.tsx","components/footer/Item.tsx","lib/svg/Prev.js","lib/svg/Next.js","lib/svg/BookClose.js","lib/svg/BookOpen.js","lib/svg/Close.js","lib/svg/Down.js","lib/svg/ScrollHorizontal.js","lib/svg/ScrollVertical.js","lib/svg/Search.js","components/footer/MoveBtn.tsx","containers/Footer.tsx","components/sideMenu/CloseBtn.tsx","components/sideMenu/Wrapper.tsx","components/nav/BookInfo.tsx","components/nav/NavItem.tsx","containers/menu/Nav.tsx","components/option/Layout.tsx","components/option/OptionWrapper.tsx","components/option/OptionTitle.tsx","components/option/DropdownValue.tsx","components/option/DropdownItemWrapper.tsx","components/option/DropdownItem.tsx","components/option/Dropdown.tsx","components/option/OptionValue.tsx","components/option/SliderValue.tsx","components/option/Slider.tsx","components/option/ControlIconBtnWrapper.tsx","components/option/ControlIconBtn.tsx","containers/menu/Option.tsx","components/note/highlight/Wrapper.tsx","components/note/highlight/Title.tsx","components/note/highlight/Post.tsx","components/note/highlight/PageNum.tsx","slices/book.ts","containers/menu/commons/Highlight.tsx","components/note/Layout.tsx","components/sideMenu/MenuEmpty.tsx","containers/menu/Note.tsx","lib/styles/viewerLayout.ts","components/contextMenu/Wrapper.tsx","components/contextMenu/ColorItem.tsx","components/contextMenu/Item.tsx","containers/commons/ContextMenu.tsx","lib/styles/animations.ts","components/commons/Snackbar.tsx","slices/snackbar.ts","containers/commons/Snackbar.tsx","components/commons/ViewerWrapper.tsx","slices/index.ts","lib/hooks/useMenu.ts","lib/hooks/useHighlight.ts","containers/Reader.tsx","index.tsx"],"names":["EpubViewerWrapper","styled","div","EpubViewer","ref","url","epubFileOptions","epubOptions","style","location","bookChanged","rendtionChanged","pageChanged","tocChanged","selectionChanged","loadingView","useState","isLoaded","setIsLoaded","book","setBook","rendition","setRendition","toc","setToc","currentCfi","useRef","initRendition","book_","node","current","rendition_","renderTo","width","height","display","length","href","movePage","useCallback","type","prev","next","handleKeyPress","key","onLocationChange","loc","startCfi","start","endCfi","end","base","slice","split","spineItem","spine","get","navItem","navigation","chapterName","label","trim","locations","currentPage","locationFromCfi","totalPage","total","onHighlight","cfiRange","callback","color","annotations","remove","highlight","registerGlobalFunc","prevPage","nextPage","getCurrentCfi","offHighlight","setLocation","useEffect","Error","destroy","Book","loaded","then","toc_","map","t","ready","stored","localStorage","getItem","load","generate","setItem","save","initBook","document","addEventListener","on","removeEventListener","off","React","forwardRef","spin","keyframes","LoadingWrapper","Wrapper","Content","LoadingView","timeFormatter","time","yyyy","getFullYear","mm","getMonth","dd","getDate","compareCfi","cfi_1","cfi_2","EpubCFI","compare","cfiRangeSpliter","origin","getParagraphCfi","viewerStyle","ReactViewer","viewerLayout","viewerOption","onBookInfoChange","onPageChange","onTocChange","onSelection","layoutStyle","setLayoutStyle","fontFamily","fontSize","lineHeight","marginHorizontal","marginVertical","bookStyle","setBookStyle","flow","resizeOnOrientationChange","spread","bookOption","setBookOption","currentSelection","contents","onResize","useMemo","debounce","viewerLayout_","MIN_VIEWER_WIDTH","MIN_VIEWER_HEIGHT","VIEWER_HEADER_HEIGHT","VIEWER_FOOTER_HEIGHT","VIEWER_SIDEMENU_WIDTH","window","win_w","innerWidth","win_h","innerHeight","componentHeight","w","h","marginTop","l","resize","onSelected","a","iframe","querySelector","iframeWin","contentWindow","selection_","getSelection","toString","Promise","resolve","setTimeout","all","metadata","opened","metaData","bookData","newBookData","coverURL","archive","urlCache","cover","title","description","published_date","Date","pubdate","modified_date","author","creator","publisher","language","catch","error","stack","newStyle","Object","assign","body","themes","register","viewerDefaultStyles","select","palette","white","black","gray0","gray1","gray2","gray3","gray4","gray5","gray6","gray7","gray8","red0","red1","red2","red3","red4","red5","red6","red7","red8","orange0","orange1","orange2","orange3","orange4","orange5","orange6","orange7","orange8","yellow0","yellow1","yellow2","yellow3","yellow4","yellow5","yellow6","yellow7","yellow8","green0","green1","green2","green3","green4","green5","green6","green7","green8","blue0","blue1","blue2","blue3","blue4","blue5","blue6","blue7","blue8","purple0","purple1","purple2","purple3","purple4","purple5","purple6","purple7","purple8","zIndexSet","layer","zIndex","header","menu","modal","snackbar","tooltip","Layout","AutoLayout","noselect","transition","boxShadow","scrollbar","mediaQuery","maxWidth","mediaValue","media","xlarge","large","medium","small","xsmall","custom","styles","Img","img","Logo","target","src","alt","Btn","button","ControlBtn","message","onClick","Header","onNavToggle","onOptionToggle","onLearningToggle","Container","Item","text","SvgPrev","props","xmlns","viewBox","id","data-name","fill","d","opacity","className","SvgNext","SvgBookClose","SvgBookOpen","SvgClose","SvgDown","stroke","strokeLinecap","strokeLinejoin","strokeWidth","SvgScrollHorizontal","cx","cy","r","SvgScrollVertical","SvgSearch","MoveBtn","Icon","PrevIcon","NextIcon","msg","Footer","nowPage","onPageMove","CloseIcon","CloseBtn","show","onClose","children","BookImg","BookContent","Title","Info","BookInfo","NavItem","Nav","control","onToggle","onLocation","useSelector","state","bookToc","Tocs","idx","open","OptionWrapper","OptionTitle","isDropdown","span","DropdownValue","value","Down","DropdownItemWrapper","DropdownItem","DropdownWrapper","Dropdown","defaultValue","valueList","onSelect","visible","setVisible","e","path","includes","Items","font","OptionValue","active","SliderWrapper","SliderBackground","SliderBar","percentage","Slider","input","SliderValue","minValue","maxValue","step","onChange","Math","round","min","max","disabled","BtnWrapper","ControlIconBtnWrapper","isSelected","css","ControlIconBtn","HeaderIcon","ScrollVerticalIcon","ScrollHorizontalIcon","BookOpenIcon","BookCloseIcon","Option","bookFlow","emitEvent","onBookStyleChange","onBookOptionChange","setFontFamily","setFontSize","setLineHeight","setMarginHorizontal","setMarginVertical","isScrollHorizontal","setIsScrollHorizontal","viewType","setViewType","onChangeSlider","onClickDirection","onClickViewType","isSpread","timer","clearTimeout","Post","PageNum","num","initialBook","initialState","currentLocation","highlights","colorList","name","code","bookSlice","createSlice","reducers","updateBook","action","payload","updateCurrentPage","clearBook","updateToc","clearToc","pushHighlight","filter","push","updateHighlight","new_idx","old_idx","indexOf","splice","popHighlight","actions","Highlight","viewerRef","dispatch","useDispatch","now","toISOString","accessTime","splitCfi","svgContainer","targetSvg","childNodes","pageNum","chpaterName","content","MenuEmpty","Note","onClickHighlight","highlightList","setHighlightList","contextmenuWidth","x","y","isReverse","ColorWrapper","Color","Message","ColorItem","blur","ContextMenu","selection","onAddHighlight","onRemoveHighlight","onUpdateHighlight","onContextmMenuRemove","menuRef","setHighlight","setDisplay","isEraseBtn","setIsEraseBtn","setIsReverse","setHeight","setY","ColorList","update","onRemoveHighlight_","onRemove","onKeyPress","paragraphCfi","filtered","highlight_","scrolledTarget","itemCnt","defaultHeight","y_","animations","fadeIn","fadeOut","fadeInTop","fadeOutTop","fadeInBottom","fadeOutBottom","fadeInLeft","fadeOutLeft","fadeInRight","fadeOutRight","Snackbar","RefEvent","newSnackbar","createAsyncThunk","event","shift","SnackbarSlice","deleteSnackbar","appendSnackbar","SnackbarWrapper","preventDefault","stopPropagation","ViewerWrapper","reducer","combineReducers","store","configureStore","useMenu","delay","eventSignal","setEventSignal","setControl","epubIframe","useHighlight","setIsContextMenu","setSelection","baseCfiRange","targetCfiRange","splitCfi1","splitCfi2","s1","e1","s2","e2","clashCfiRange","removeAllRanges","position","viewer","CONTEXTMENU_WIDTH","windowWidth","windowHeight","iframeWidth","offsetWidth","scrollTop","rangeCount","getRangeAt","getBoundingClientRect","selectionX","selectionY","selectionHeight","selectionWidth","getSelectionPosition","highlightNode","targetNode","parentElement","dataset","epubcfi","createTime","forEach","cfi","replace","cfiPath","Number","iframeBody","component","n","bookmark","getNodefromCfi","Reader","navRef","optionRef","learningRef","isContextMenu","navControl","optionControl","learningControl","page","result","bookStyle_","bookOption_","ReaderWrapper","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.cf646646.chunk.js","sourcesContent":["import styled from 'styled-components'\n\nconst EpubViewerWrapper = styled.div`\n\twidth: 100%;\n\tbox-sizing: border-box;\n\tmargin: 0 auto;\n\t\n\t& > div {\n\t\t&::-webkit-scrollbar {\n\t\t\tdisplay: none;\n\t\t}\n\t}\n`;\n\nexport default EpubViewerWrapper","import React, { useState, useEffect, useCallback, useRef } from 'react'\nimport { Book, Rendition } from \"epubjs\";\n// style\nimport EpubViewerWrapper from 'modules/epubViewer/style'\n// types\nimport { EpubViewerProps, ViewerRef } from 'types'\nimport Toc from 'types/toc'\nimport Loc from 'types/loc'\n\n\n/**\n * EpubViewer Module\n * @class\n * @param props\n * @param props.url Epub path\n * @param props.epubFileOptions Epub file option\n * @param props.epubOptions Epub viewer option\n * @param props.style Epub Wrapper style\n * @param props.location Epub CFI or href\n * @param props.bookChanged Run when book changed\n * @param props.rendtionChanged Run when rendition changed\n * @param props.pageChanged Run when page changed\n * @param props.tocChanged Run when toc changed\n * @param props.selectionChanged Run when selected\n * @param props.loadingView Loading Component\n * @param ref Viewer ref\n */\nconst EpubViewer = ({\n  url, \n  epubFileOptions, \n  epubOptions,\n  style,\n  location,\n  bookChanged,\n  rendtionChanged,\n  pageChanged,\n  tocChanged,\n  selectionChanged,\n  loadingView,\n}: EpubViewerProps, ref: React.RefObject<ViewerRef> | any) => {\n  // TODO Fix the ref type correctly instead 'any' type.\n  const [isLoaded, setIsLoaded] = useState(false);\n\n  const [book, setBook] = useState<Book | null>(null);\n\n  const [rendition, setRendition] = useState<Rendition | null>(null);\n\n  const [toc, setToc] = useState<Toc[]>([]);\n\n  const currentCfi = useRef<string>('');\n\n  \n\n  /**\n   * Init Book\n   * @method\n   * - Set book state\n   * - Set Epub path state\n   * - Set isLoaded state\n   * - Set toc state\n   */\n  const initBook = () => {\n    if (book) {\n      book.destroy();\n    }\n    \n    const book_ = new Book(url, epubFileOptions);\n    setBook(book_);\n\n    bookChanged && bookChanged(book_);\n\n    book_.loaded.navigation.then(({ toc }) => {\n      const toc_: Toc[] = toc.map(t => ({ \n        label: t.label, \n        href: t.href \n      }));\n      \n      setIsLoaded(true);\n      setToc(toc_);\n      tocChanged && tocChanged(toc_);\n      initRendition(book_);\n    });\n\n    // Init Location & Pagination\n    book_.ready.then(function() {\n      const stored = localStorage.getItem(book_.key() + '-locations');\n      if (stored) {\n          return book_.locations.load(stored);\n      } else {\n          return book_.locations.generate(1024);\n      }\n    }).then(() => {\n      localStorage.setItem(book_.key() + '-locations', book_.locations.save());\n    });\n  };\n\n  /**\n   * Init Rendition\n   * @method\n   * - Init iframe tag on DOM element\n   * - Set rendition\n   * - Set start page\n   */\n  const initRendition = (book_: Book) => {\n    const node = ref.current;\n    if (!node || !book_) return;\n    \n    const rendition_ = book_.renderTo(node, {\n      width: \"100%\",\n      height: \"100%\",\n      ...epubOptions\n    });\n    setRendition(rendition_);\n    \n    rendtionChanged && rendtionChanged(rendition_);\n\n    if(typeof location === \"string\") {\n      rendition_.display(location);\n    } else if(toc.length > 0 && toc[0].href) {\n      rendition_.display(toc[0].href);\n    } else {\n      rendition_.display();\n    }\n  }\n\n  /**\n   * Move page\n   * @method\n   * @param type direction\n   */\n  const movePage = useCallback((type: \"PREV\" | \"NEXT\") => {\n    if (!rendition) return;\n    if (type === \"PREV\") rendition.prev();\n    else rendition.next();\n  }, [rendition]);\n\n  /**\n   * Move page by arrow key\n   * @method\n   * @param props Keyboard Event\n   * @param props.key \n   */\n  const handleKeyPress = useCallback(({ key }: any) => {\n    key && key === \"ArrowLeft\" && movePage(\"PREV\");\n    key && key === \"ArrowRight\" && movePage(\"NEXT\");\n  }, [movePage]);\n\n  /**\n   * Run when location changed\n   * @method\n   * @param loc\n   * - Set location state\n   * - Run 'locationChanged()' through startCFI\n   */\n  const onLocationChange = useCallback((loc: Loc) => {\n    const startCfi = loc && loc.start;\n    const endCfi = loc && loc.end;\n    const base = loc && loc.start.slice(8).split('!')[0];\n\n    if (!book) return;\n\n    const spineItem = book.spine.get(startCfi);\n    const navItem = book.navigation.get(spineItem.href);\n    const chapterName = navItem && navItem.label.trim();\n\n    const locations: any = book.locations;\n    const currentPage = locations.locationFromCfi(startCfi);\n    const totalPage = locations.total;\n\n    pageChanged && pageChanged({\n      chapterName, \n      currentPage, \n      totalPage, \n      startCfi, \n      endCfi,\n      base\n    });\n\n    currentCfi.current = startCfi;\n  }, [book, pageChanged]);\n\n  /**\n   * Highlight function\n   * @param cfiRange Selecton CFIRange\n   * @param color Highlight color\n   * @param callback Highlight callback function when click it\n   */\n   const onHighlight = useCallback((\n    cfiRange: string, \n    callback: (e: any) => void,\n    color?: string\n  ) => {\n    if (!rendition) return;\n\n    rendition.annotations.remove(cfiRange, 'highlight');\n    rendition.annotations.highlight(\n      cfiRange, \n      {}, \n      callback, \n      \"epub-highlight\",\n      { 'fill': color || '#fdf183' }\n    );\n  }, [rendition]);\n\n  /**\n   * Register viewer control function\n   * @method\n   * - REF.CURRENT.prevPage() : Move prev page\n   * - REF.CURRENT.nextPage() : Move next page\n   * - REF.CURRENT.getCurrentCfi() : Get current CFI\n   * - REF.CURRENT.onHighlight(): Set highlight\n   * - REF.CURRENT.offHighlight(): Remove specific highliht\n   * - REF.CURRENT.seLocation(): Move to specific cfi or href\n   */\n  const registerGlobalFunc = useCallback(() => {\n    if (!ref.current) return;\n    if (movePage) {\n      ref.current.prevPage = () => movePage(\"PREV\");\n      ref.current.nextPage = () => movePage(\"NEXT\");\n    }\n    ref.current.getCurrentCfi = () => currentCfi.current;\n    if (onHighlight) {\n      ref.current.onHighlight = onHighlight;\n    }\n    if (rendition) {\n      ref.current.offHighlight = (cfiRange: string) => rendition.annotations.remove(cfiRange, 'highlight');\n      ref.current.setLocation = (location: string) => rendition.display(location);\n    }\n  }, [ref, rendition, movePage, onHighlight]);\n\n\n\n  /** Ref checker */\n  useEffect(() => {\n    if (!ref) {\n      throw new Error(\"[React-Epub-Viewer] Put a ref argument that has a ViewerRef type.\");\n    }\n  }, [ref]);\n\n  /** Epub Init */\n  /* eslint-disable */\n  useEffect(() => {\n    if (!url) return;\n    initBook();\n  }, [url]);\n  /* eslint-enable */\n\n  /** \n   * Emit Viewer Event\n   * - Register move event\n   * - Register location changed event\n   * - Register selection event\n   */\n  /* eslint-disable */\n  useEffect(() => {\n    if (!rendition) return;\n\n    // Emit global control function\n    registerGlobalFunc();\n\n    document.addEventListener('keyup', handleKeyPress, false);\n    rendition.on(\"keyup\", handleKeyPress);\n    rendition.on(\"locationChanged\", onLocationChange);\n    selectionChanged && rendition.on('selected', selectionChanged);\n\n    return (() => {\n      document.removeEventListener('keyup', handleKeyPress, false);\n      rendition.off(\"keyup\", handleKeyPress);\n      rendition.off(\"locationChanged\", onLocationChange);\n      selectionChanged && rendition.off('selected', selectionChanged);\n    });\n  }, [\n    rendition,\n    registerGlobalFunc,\n    handleKeyPress\n  ]);\n  /* eslint-enable */\n\n  /** Display page by changed location */\n  useEffect(() => {\n    if (!location || !rendition) return;\n\n    rendition.display(location);\n  }, [location, rendition]);\n\n  \n  return (<>\n    {!isLoaded && loadingView}\n    <EpubViewerWrapper ref={ref} style={style} />\n  </>);\n}\n\nexport default React.forwardRef(EpubViewer)","import styled, { keyframes } from 'styled-components'\n\nconst LoadingView = () => {\n  return (\n    <LoadingWrapper>\n      <Wrapper>\n        <Content />\n      </Wrapper>\n    </LoadingWrapper>\n  );\n}\n\nconst spin = keyframes`\n\tfrom { transform: rotate(0deg); }\n\tto { transform: rotate(360deg); }\n`;\n\nconst LoadingWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst Wrapper = styled.div`\n\tposition: relative;\n\twidth: 100%;\n\theight: 30px;\n\tmargin: 30px 0;\n\ttext-align: center;\n`;\n\nconst Content = styled.div`\n\tdisplay: inline-block;\n\twidth: 30px;\n\theight: 30px;\n\tborder: 3px solid #ebf1ff;\n\tborder-radius: 50%;\n\tborder-top-color: #3972ff;\n\tanimation: ${spin} 1s ease-in-out infinite;\n`;\n\nexport default LoadingView","import { EpubCFI } from 'epubjs'\n// types\nimport { BookStyle, BookFlow } from 'types/book'\n\n\n/**\n * DateTime to `yyyy-mm-dd`\n * @param {Date} time \n */\n export const timeFormatter = (time: Date): string => {\n\tconst yyyy = time.getFullYear();\n\tconst mm = time.getMonth() + 1;\n\tconst dd = time.getDate();\n\tconst msg = `${yyyy}-${mm}-${dd}`;\n\n\treturn msg;\n}\n\n\n/**\n * Comparison of two CFI sizes\n * - -1 : CFI 1 < CFI 2\n * - 0 : CFI 1 == CFI 2\n * - 1 : CFI 1 > CFI 2\n * @param cfi_1 CFI 1\n * @param cfi_2 CFI 2\n */\nexport const compareCfi = (cfi_1: string, cfi_2: string): number => {\n\tconst epubcfi = new EpubCFI();\n\treturn epubcfi.compare(cfi_1, cfi_2);\n};\n\n\n/**\n * Split CFI range into two starting CFI and ending CFI\n * - null : Invalid CFIRange\n * @param cfiRange CFIRange\n */\nexport const cfiRangeSpliter = (cfiRange: string) => {\n\tconst content = cfiRange.slice(8, -1);\n\tconst [origin, start, end] = content.split(',');\n\n\tif (!origin || !start || !end) return null;\n\n\tconst startCfi = `epubcfi(${origin + start})`;\n\tconst endCfi = `epubcfi(${origin + end})`;\n\treturn { startCfi, endCfi }\n}\n\n\n/**\n * Whether the two CFI ranges nested\n * - true : Nested\n * - false : Not nested\n * - null : Invalid CFIRange\n * @param cfiRange1 First CFIRange\n * @param cfiRange2 Second CFIRange\n */\nexport const clashCfiRange = (baseCfiRange: string, targetCfiRange: string) => {\n\tconst splitCfi1 = cfiRangeSpliter(baseCfiRange);\n\tconst splitCfi2 = cfiRangeSpliter(targetCfiRange);\n\n\tif (!splitCfi1 || !splitCfi2) return null;\n\n\tconst { startCfi: s1, endCfi: e1 } = splitCfi1;\n\tconst { startCfi: s2, endCfi: e2 } = splitCfi2;\n\n\tif ((compareCfi(s2, s1) <= 0 && compareCfi(s1, e2) <= 0)\n\t\t||(compareCfi(s2, e1) <= 0 && compareCfi(e1, e2) <= 0)\n\t\t||(compareCfi(s1, s2) <= 0 && compareCfi(e2, e1) <= 0)) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n\n/**\n * Extract paragraph CFI from CFIRange\n * - null : Invalid CFIRange\n * @param cfiRange CFIRange\n */\nexport const getParagraphCfi = (cfiRange: string) => {\n\tif (!cfiRange) return;\n\n\tconst content = cfiRange.slice(8, -1);\n\tconst [origin, start, end] = content.split(',');\n\t\n\tif (!origin || !start || !end) return null;\n\n\tconst cfi = `epubcfi(${origin})`;\n\treturn cfi;\n}\n\n\n/**\n * Get specific DOM Element from CFI\n * - **※ Warning**: Other Iframe must not exist in the Reader page!\n * @param cfi CFI\n * @returns HTML Element or Null\n */\nexport const getNodefromCfi = (cfi: string): HTMLElement | null => {\n\tconst epubcfi = cfi.slice(8, -1);\n\n\t/* Remove Id */\n\tconst pureCfi = epubcfi.replace(/\\[.*?\\]/gi, '');\n\n\t/* Only CFI Base */\n\tconst splitCfi = pureCfi.split('!');\n\tif (splitCfi.length < 1 || splitCfi[1] === \"\") {\n\t\treturn null;\n\t}\n\n\t/* Remove Body tag CFI */\n\tconst cfiPath: number[] = splitCfi[1].split('/')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t .slice(2)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t .map(x => Number(x));\n\n\tconst iframe = document.querySelector('iframe');\n\tif (!iframe) return null;\n\t\n\tconst iframeBody = iframe.contentWindow && iframe.contentWindow.document.body;\n\tif (!iframeBody) return null;\n\n\tlet component: HTMLElement | null = iframeBody;\n\n\t/* Find Node based on CFI */\n\tfor (let idx of cfiPath) {\n\t\tconst childNodes: any = component && component.childNodes;\n\n\t\t/* Bookmark / Highlight filtering.. */\n\t\tconst filtered = ([...childNodes].filter(n => !n.dataset \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t|| !n.dataset.bookmark\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t|| !n.dataset.highlight ));\n\t\tcomponent = filtered[idx - 1];\n\n\t\tif (!component) {\n\t\t\tcomponent = null;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn component;\n}\n\n\n/**\n * Selection absolute location\n * @param viewer viewerRef.current\n * @param bookStyle bookStyle\n * @param bookFlow book-flow\n * @param MIN_VIEWER_WIDTH min viewer width\n * @param MIN_VIEWER_HEIGHT min viewer height\n * @param VIEWER_HEADER_HEIGHT viewer header height\n * @param CONTEXTMENU_WIDTH contextmenu width\n * @returns Contextmenu location\n */\nexport const getSelectionPosition = (\n\tviewer: any,\n\tbookStyle: BookStyle,\n\tbookFlow: BookFlow,\n\tMIN_VIEWER_WIDTH: number,\n\tMIN_VIEWER_HEIGHT: number,\n\tVIEWER_HEADER_HEIGHT: number,\n\tCONTEXTMENU_WIDTH: number\n): { x: number, y: number, height: number, width: number } | null => {\n\tconst { \n\t\tinnerWidth: windowWidth,\n\t\tinnerHeight: windowHeight \n\t} = window;\n\n\tconst iframeWidth = viewer.offsetWidth;\n\n\tconst scrollTop = viewer.querySelector('div').scrollTop;\n\n\tconst iframe = viewer.querySelector('iframe');\n\tconst selection_ = iframe && iframe.contentWindow && iframe.contentWindow.getSelection();\n\tif (!selection_ || selection_.rangeCount === 0) return null;\n\n\tconst range = selection_.getRangeAt(0);\n\tconst {\n\t\tx: selectionX,\n\t\ty: selectionY,\n\t\theight: selectionHeight,\n\t\twidth: selectionWidth\n\t} = range.getBoundingClientRect();\n\n\tconst marginLeft = ~~((windowWidth - MIN_VIEWER_WIDTH) / 100 * bookStyle.marginHorizontal / 2);\n\tconst marginTop = bookFlow === \"scrolled-doc\"\n\t\t? 0\n\t\t: ~~((windowHeight - VIEWER_HEADER_HEIGHT - MIN_VIEWER_HEIGHT) / 100 * bookStyle.marginVertical / 2);\n\n\tconst x = ~~(selectionX % iframeWidth + marginLeft + ( selectionWidth / 2 - CONTEXTMENU_WIDTH / 2));\n\tconst y = ~~(selectionY + selectionHeight + VIEWER_HEADER_HEIGHT + marginTop - scrollTop);\n\n\treturn { \n\t\tx, \n\t\ty, \n\t\theight: selectionHeight, \n\t\twidth: selectionWidth \n\t};\n}","const viewerStyle = {\n\t\"::selection\": {\n\t\t\"background-color\": \"#d4e9ff\"\n\t},\n\t\n\t\"img\": {\n\t\t\"-webkit-touch-callout\": \"none\",\n\t\t\"-webkit-user-select\": \"none\",\n\t\t\"-khtml-user-select\": \"none\",\n\t\t\"-moz-user-select\": \"none\",\n\t\t\"-ms-user-select\": \"none\",\n\t\t\"user-select\": \"none\"\n\t}\n}\n\nexport default viewerStyle","import React, { useState, useEffect, useRef, useCallback, useMemo } from \"react\"\nimport { Book, Rendition, Contents } from \"epubjs\"\nimport { debounce } from \"throttle-debounce\"\n// modules\nimport EpubViewer from \"modules/epubViewer/EpubViewer\"\n// components\nimport LoadingView from 'LoadingView'\n// utils\nimport { timeFormatter } from 'lib/utils/commonUtil'\n// styles\nimport viewerDefaultStyles from 'modules/reactViewer/viewerStyle'\n// types\nimport { ReactViewerProps, ViewerRef } from 'types'\nimport BookType, { BookStyle, BookOption } from 'types/book'\n\n\n/**\n * Epub React Viewer Module\n * @class\n * @param props\n * @param props.url Epub file path\n * @param props.viewerLayout Viewer layout\n * @param props.viewerStyle Viewer style\n * @param props.viewerOption Viewer option\n * @param props.onBookInfoChange Run when book information changed\n * @param props.onPageChange Run when page changed\n * @param props.onTocChange Run when toc changed\n * @param props.onSelection Run when selected\n * @param props.loadingView Loading component\n * @param ref Viewer ref\n */\nconst ReactViewer = ({ \n  url,\n  viewerLayout,\n  viewerStyle,\n  viewerOption,\n  onBookInfoChange,\n  onPageChange,\n  onTocChange,\n  onSelection,\n  loadingView\n}: ReactViewerProps, ref: React.RefObject<ViewerRef> | any) => {\n  // TODO Fix the ref type correctly instead 'any' type.\n  const [book, setBook] = useState<Book | null>(null);\n\n  const [rendition, setRendition] = useState<Rendition | null>(null);\n\n  const [layoutStyle, setLayoutStyle] = useState<Object>({});\n\n  const [bookStyle, setBookStyle] = useState<BookStyle>({\n    fontFamily: 'Origin',\n    fontSize: 18,\n    lineHeight: 1.4,\n    marginHorizontal: 15,\n    marginVertical: 5\n  });\n  \n  const [bookOption, setBookOption] = useState<BookOption>({\n    flow: \"paginated\",\n    resizeOnOrientationChange: true,\n    spread: \"auto\"\n  });\n\n  const currentSelection = useRef<{cfiRange:string, contents:Contents | null}>({\n    cfiRange: '',\n    contents: null\n  });\n  \n\n\n  /**\n   * Run book changed\n   * @method\n   * @param book Epub Book\n   */\n  const bookChanged = (book: Book) => setBook(book);\n\n  /**\n   * Run rendition changed\n   * @method\n   * @param rendition Epub Rendition\n   */\n  const rendtionChanged = (rendition: Rendition) => setRendition(rendition);\n\n  /**\n   * Run selection changed [Debounce]\n   * @method\n   * @param cfiRange CFIRange\n   * @param contents Selection Epub Contents\n   */\n  const selectionChanged = (cfiRange: string, contents: Contents) => {\n    currentSelection.current = { cfiRange, contents };\n  }\n\n  /**\n   * Viewer resizing function\n   * @method\n   */\n  const onResize = useMemo(() => debounce(250, () => {\n    if (!rendition) return;\n\n    const viewerLayout_ = viewerLayout || {\n      MIN_VIEWER_WIDTH: 600,\n      MIN_VIEWER_HEIGHT: 300,\n      VIEWER_HEADER_HEIGHT: 0,\n      VIEWER_FOOTER_HEIGHT: 0,\n      VIEWER_SIDEMENU_WIDTH: 0\n    };\n    \n    const { innerWidth: win_w, innerHeight: win_h } = window;\n    const componentHeight = viewerLayout_.VIEWER_HEADER_HEIGHT + viewerLayout_.VIEWER_FOOTER_HEIGHT;\n    const w = win_w - ~~((win_w - viewerLayout_.MIN_VIEWER_WIDTH) / 100 * bookStyle.marginHorizontal);\n    const h = bookOption.flow === \"scrolled-doc\"\n      ? win_h - componentHeight\n      : win_h - componentHeight - ~~((win_h - componentHeight - viewerLayout_.MIN_VIEWER_HEIGHT) / 100 * bookStyle.marginVertical);\n    const marginTop = bookOption.flow === \"scrolled-doc\"\n      ? \"\"\n      : `${~~((win_h - componentHeight - viewerLayout_.MIN_VIEWER_HEIGHT) / 100 * bookStyle.marginVertical) / 2}px`;\n\n    setLayoutStyle(l => ({\n      ...l,\n      width: w,\n      height: h,\n      marginTop\n    }));\n    \n    try {\n      rendition.resize(w, h);\n    } catch { }\n  }), [\n    rendition,\n    viewerLayout,\n    bookStyle.marginHorizontal,\n    bookStyle.marginVertical,\n    bookOption.flow\n  ]);\n\n  /**\n   * Selection Event, run when run mouseup event\n   * @method <br/>\n   * - Fire after the Epubjs selected event. [about 300ms]\n   */\n  const onSelected = useCallback(async () => {\n    if (!ref.current) return;\n\n\t\tconst iframe = ref.current.querySelector('iframe');\n\t\tif (!iframe) return;\n    \n\t\tconst iframeWin = iframe.contentWindow;\n\t\tif (!iframeWin) return;\n    \n\t\tconst selection_ = iframeWin.getSelection();\n    if (!selection_) return;\n\t\t\n\t\tconst selectionText = selection_.toString();\n\t\tif (selectionText === \"\") return;\n    \n    const cfiRange: string = await new Promise(resolve => \n      setTimeout(() => resolve(currentSelection.current.cfiRange), 350)\n    );\n    if (!cfiRange) return;\n    \n    const contents = currentSelection.current.contents;\n    if (!contents) return;\n\n    onSelection && onSelection(cfiRange, contents);\n  }, [ref, onSelection]);\n  \n\n\n  /** Ref checker */\n  useEffect(() => {\n    if (!ref) {\n      throw new Error(\"[React-Epub-Viewer] Put a ref argument that has a ViewerRef type.\");\n    }\n  }, [ref]);\n\n\t/** Epub parsing */\n  // TODO Fix the infinite re-rendering issue, when inlcude `onBookInfoChange` to dependencies array.\n  /* eslint-disable */\n  useEffect(() => {\n    if (!book) return;\n\n    Promise.all([\n\t\t\tbook.loaded.metadata,\n\t\t\tbook.opened\n\t\t])\n\t\t.then(([metaData, bookData]: any[]) => {\n      const newBookData: BookType = {\n\t\t\t\tcoverURL: bookData.archive.urlCache[bookData.cover],\n\t\t\t\ttitle: metaData.title,\n\t\t\t\tdescription: metaData.description,\n\t\t\t\tpublished_date: timeFormatter(new Date(metaData.pubdate)),\n\t\t\t\tmodified_date: timeFormatter(new Date(metaData.modified_date)),\n\t\t\t\tauthor: metaData.creator,\n\t\t\t\tpublisher: metaData.publisher,\n\t\t\t\tlanguage: metaData.language\n\t\t\t}\n\n      onBookInfoChange && onBookInfoChange(newBookData);\n    })\n\t\t.catch(error => {\n      throw `${error.stack} \\n\\n Message : Epub parsing failed.`;\n\t\t});\n  }, [book]);\n  /* eslint-enable */\n\n  /** Set viewer Styles/Options */\n  useEffect(() => {\n    viewerStyle && setBookStyle(viewerStyle);\n    viewerOption && setBookOption(viewerOption);\n  }, [viewerStyle, viewerOption]);\n\n  /** Apply viewer Styles/Options */\n  useEffect(() => {\n    if (!rendition) return;\n\n    onResize();\n\n    const newStyle = {\n      \"body\": {\n        \"padding-top\": \"0px !important\",\n        \"padding-bottom\": \"0px !important\"\n      },\n      \"p\": {\n        \"font-size\": `${bookStyle.fontSize}px !important`,\n        \"line-height\": `${bookStyle.lineHeight} !important`\n      },\n    };\n    \n    rendition.flow(bookOption.flow);\n    rendition.spread(bookOption.spread);\n\n    if (bookStyle.fontFamily !== \"Origin\") {\n      Object.assign(newStyle.body, {\n        \"font-family\": `${bookStyle.fontFamily} !important`\n      });\n    }\n\n    if (bookOption.flow === \"scrolled-doc\") {   // Scroll type\n      Object.assign(newStyle.body, {\n        \"margin\": \"auto !important\"\n      });\n    } else if (bookOption.spread === \"auto\") {  // View 2 pages\n      Object.assign(newStyle.body, { });\n    } else {                                    // View 1 page\n      Object.assign(newStyle.body, { });\n    }\n  \n    rendition.themes.register(\"main\", viewerDefaultStyles);\n    rendition.themes.register(\"default\", newStyle);\n\n    rendition.themes.select(\"main\");\n  }, [\n    rendition, \n    bookStyle.fontFamily,\n    bookStyle.fontSize,\n    bookStyle.lineHeight,\n    bookOption,\n    onResize\n  ]);\n\n  /** Emit screen resizing event */\n  useEffect(() => {\n    window.addEventListener('resize', onResize);\n    return () => window.removeEventListener('resize', onResize);\n  }, [onResize]);\n\n  /** Emit selection event */\n  useEffect(() => {\n    if (!rendition) return;\n    rendition.on(\"mouseup\", onSelected);\n\t\treturn () => rendition.off(\"mouseup\", onSelected);\n  }, [rendition, onSelected]);\n\n  \n\n  return (<>\n    <EpubViewer \n      url={url} \n      style={layoutStyle}\n      bookChanged={bookChanged} \n      rendtionChanged={rendtionChanged} \n      tocChanged={onTocChange} \n      pageChanged={onPageChange}\n      selectionChanged={selectionChanged}\n      loadingView={loadingView || <LoadingView />}\n      ref={ref}\n    />\n  </>);\n}\n\nexport default React.forwardRef(ReactViewer)","/*\n :::: Color Varient ::::\n*/\nconst palette = {\n  white: '#ffffff',\n  black: '#000000',\n  /* gray */\n  gray0: '#fafafa',\n  gray1: '#e7e7e7',\n  gray2: '#c3c3c3',\n  gray3: '#9e9e9e',\n  gray4: '#868686',\n  gray5: '#656565',\n  gray6: '#505050',\n  gray7: '#3c3c3c',\n  gray8: '#282828',\n  /* red */\n  red0: '#ffe8e8',\n  red1: '#ffd0d1',\n  red2: '#ff8a8b',\n  red3: '#ff4445',\n  red4: '#ff1517',\n  red5: '#bf1011',\n  red6: '#990d0e',\n  red7: '#73090a',\n  red8: '#4d0607',\n  /* orange */\n  orange0: '#fff0ec',\n  orange1: '#ffe2d9',\n  orange2: '#ffb6a0',\n  orange3: '#ff8966',\n  orange4: '#ff6c40',\n  orange5: '#bf5130',\n  orange6: '#994126',\n  orange7: '#73311d',\n  orange8: '#4d2013',\n  /* yellow */\n  yellow0: '#fffce6',\n  yellow1: '#fffacc',\n  yellow2: '#fff280',\n  yellow3: '#feea33',\n  yellow4: '#fee500',\n  yellow5: '#bfac00',\n  yellow6: '#988900',\n  yellow7: '#726700',\n  yellow8: '#4c4500',\n  /* green */\n  green0: '#e6f7e6',\n  green1: '#cdefcc',\n  green2: '#83d880',\n  green3: '#39c133',\n  green4: '#07b100',\n  green5: '#058500',\n  green6: '#046a00',\n  green7: '#035000',\n  green8: '#023500',\n  /* blue */\n  blue0: '#ebf1ff',\n  blue1: '#d7e3ff ',\n  blue2: '#9cb9ff ',\n  blue3: '#618eff ',\n  blue4: '#3972ff ',\n  blue5: '#2b56bf ',\n  blue6: '#224499 ',\n  blue7: '#1a3373 ',\n  blue8: '#11224d ',\n  /* purple */\n  purple0: '#f2ebff',\n  purple1: '#d7e3ff',\n  purple2: '#be9cff',\n  purple3: '#9761ff',\n  purple4: '#7d39ff',\n  purple5: '#5e2bbf',\n  purple6: '#4b2299',\n  purple7: '#381a73',\n  purple8: '#26114d',\n};\n\nexport default palette","export const zIndexSet = (layer: number): string => `\n\t${layer}\n`;\n\nconst zIndex = {\n\theader: zIndexSet(5),\n\tmenu: zIndexSet(10),\n\tmodal: zIndexSet(100),\n\tsnackbar: zIndexSet(400),\n\ttooltip: zIndexSet(500)\n};\n\nexport default zIndex;","import styled from 'styled-components'\n// lib\nimport palette from 'lib/styles/palette'\nimport zIndex from 'lib/styles/zIndex'\n\nconst Wrapper = styled.div`\n  position: sticky;\n  width: 100%;\n  height: auto;\n  left: 0;\n  top: 0;\n  background-color: ${palette.white};\n  z-index: ${zIndex.header};\n`;\n\nexport default Wrapper","import styled from 'styled-components'\n// lib\nimport palette from 'lib/styles/palette'\nimport zIndex from 'lib/styles/zIndex'\n\nconst Layout = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 64px;\n  z-index: ${zIndex.header};\n`;\n\nexport const AutoLayout = styled.div`\n  width: 100%;\n  flex-grow: 1;\n  display: flex;\n  justify-content: space-between;\n  border-bottom: 2px solid ${palette.gray1};\n\n  & > div {\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n  }\n  & > div:last-child {\n    margin-right: 8px;\n  }\n`;\n\nexport default Layout","export const noselect = (): string => `\n\t-webkit-touch-callout: none;\n\t-webkit-user-select: none;\n\t-khtml-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n`;\n\nexport const transition = (): string =>`\n\tcubic-bezier(0.25, 0.1, 0.25, 1);\n`;\n\nexport const boxShadow = {\n\tlight: \"0px 4px 16px rgba(0, 0, 0, 0.04)\",\n\tregular: \"0px 8px 12px rgba(0, 0, 0, 0.2)\",\n\tbold: \"0 8px 10px 1px rgba(0,0,0,0.14), 0 3px 8px 2px rgba(0,0,0,0.12), 0 5px 5px -3px rgba(0,0,0,0.2)\"\n};\n\nexport const scrollbar = (width=8) => `\n\t&::-webkit-scrollbar {\n\t\twidth: ${width}px;\n\t\tbackground: transparent;\n\t}\n\t&::-webkit-scrollbar-thumb {\n\t\tbackground: #ddd;\n\t\tborder-radius: 10px;\n\t}\n\t&::-webkit-scrollbar-thumb:hover {\n\t\tbackground: #ccc;\n\t}\n\t&::-webkit-scrollbar-track {\n\t\tbackground: transparent;\n\t}\n`","export const mediaQuery = (maxWidth: number): string => `\n\t@media (max-width: ${maxWidth}px)\n`;\n\nexport const mediaValue = {\n\txlarge: 1600,\n\tlarge: 1440,\n\tmedium: 1200,\n\tsmall: 702,\n\txsmall: 350\t\n};\n\ntype Media = {\n\txlarge : string,\n\tlarge : string,\n\tmedium : string,\n\tsmall : string,\n\txsmall : string,\n\tcustom : (maxWidth: number) => string\n}\n\nconst media: Media = {\n\txlarge : mediaQuery(mediaValue.xlarge),\n\tlarge : mediaQuery(mediaValue.large),\n\tmedium : mediaQuery(mediaValue.medium),\n\tsmall : mediaQuery(mediaValue.small),\n\txsmall : mediaQuery(mediaValue.xsmall),\n\tcustom : mediaQuery,\n};\n\nexport default media;","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport palette from 'lib/styles/palette'\nimport { mediaQuery } from 'lib/styles/media'\n\nconst Logo = () => {\n\treturn (\n\t\t<Wrapper href=\"https://github.com/altmshfkgudtjr/react-epub-viewer\" target=\"__blank__\">\n\t\t\t<Img src=\"/react-epub-viewer/images/logo.png\" alt=\"Logo\" />\n\t\t</Wrapper>\n\t);\n} \n\nconst Wrapper = styled.a`\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\toutline: none;\n\tmargin-left: 16px;\n\tbackground-color: rgba(0,0,0,0);\n\ttransition: .2s ${styles.transition};\n\tborder-radius: 8px;\n\tpadding: 4px 8px;\n\tcursor: pointer;\n\n\t${mediaQuery(700)} {\n\t\tdisplay: none;\n\t}\n\n\t&:focus, &:hover {\n\t\tbackground-color: ${palette.blue0};\n\t}\n`;\n\nconst Img = styled.img`\n\theight: 44px;\n`;\n\nexport default Logo","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport palette from 'lib/styles/palette'\n\nconst ControlBtn = ({ message, onClick }: Props) => {\n  return <Btn onClick={() => onClick()}>{message}</Btn>;\n}\n\nconst Btn = styled.button`\n  height: 100%;\n  padding: 0 16px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: .1s ${styles.transition};\n  outline: none;\n\n  &:focus, &:hover {\n    color: ${palette.blue3};\n  }\n\n  &:first-child {\n    margin-left: 8px;\n  }\n`;\n\ninterface Props {\n  message: string;\n  onClick: (value?: boolean) => void;\n}\n\nexport default ControlBtn","// components\nimport Wrapper from 'components/header/Wrapper'\nimport Layout, { AutoLayout } from 'components/header/Layout'\nimport Logo from 'components/header/Logo'\nimport ControlBtn from 'components/header/ControlBtn'\n\nconst Header = ({\n  onNavToggle, \n  onOptionToggle, \n  onLearningToggle\n}: Props) => {\n  return (\n    <Wrapper>\n      <Layout>\n        <AutoLayout>\n          <Logo />\n          <div>\n            <ControlBtn message=\"Contents\" onClick={onNavToggle} />\n            <ControlBtn message=\"Setting\" onClick={onOptionToggle} />\n            <ControlBtn message=\"Highlights\" onClick={onLearningToggle} />\n          </div>\n        </AutoLayout>\n      </Layout>\n    </Wrapper>\n  );\n}\n\ninterface Props {\n  onNavToggle: (value?: boolean) => void;\n  onOptionToggle: (value?: boolean) => void;\n  onLearningToggle: (value?: boolean) => void;\n}\n\nexport default Header","import styled from 'styled-components'\n// lib\nimport palette from 'lib/styles/palette'\n\nconst Wrapper = styled.div`\n  position: fixed;\n  left: 0;\n  bottom: 0;\n  width: 100%;\n  height: 60px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: ${palette.white};\n`;\n\nexport default Wrapper","import styled from 'styled-components'\n// lib\nimport palette from 'lib/styles/palette'\n\nconst Item = ({ text }: Props) => {\n  return (\n    <Container>\n      <span>{text}</span>\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  height: 100%;\n  flex-basis: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n\n  & > span {\n    color: ${palette.gray4};\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n`;\n\ninterface Props {\n  text: string;\n}\n\nexport default Item;","import * as React from \"react\";\n\nfunction SvgPrev(props) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 44 44\" {...props}>\n      <defs>\n        <style>\n          {\n            \".prev_svg__cls-3{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}\"\n          }\n        </style>\n      </defs>\n      <g id=\"prev_svg__\\uB808\\uC774\\uC5B4_2\" data-name=\"\\uB808\\uC774\\uC5B4 2\">\n        <g\n          id=\"prev_svg__\\uB808\\uC774\\uC5B4_1-2\"\n          data-name=\"\\uB808\\uC774\\uC5B4 1\"\n        >\n          <path fill=\"none\" d=\"M0 0h44v44H0z\" opacity={0.3} />\n          <path className=\"prev_svg__cls-3\" d=\"M12 22L32 2M12 22l20 20\" />\n        </g>\n      </g>\n    </svg>\n  );\n}\n\nexport default SvgPrev;\n","import * as React from \"react\";\n\nfunction SvgNext(props) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 44 44\" {...props}>\n      <defs>\n        <style>\n          {\n            \".next_svg__cls-3{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}\"\n          }\n        </style>\n      </defs>\n      <g id=\"next_svg__\\uB808\\uC774\\uC5B4_2\" data-name=\"\\uB808\\uC774\\uC5B4 2\">\n        <g\n          id=\"next_svg__\\uB808\\uC774\\uC5B4_1-2\"\n          data-name=\"\\uB808\\uC774\\uC5B4 1\"\n        >\n          <path fill=\"none\" d=\"M0 0h44v44H0z\" opacity={0.3} />\n          <path className=\"next_svg__cls-3\" d=\"M32 22L12 2M32 22L12 42\" />\n        </g>\n      </g>\n    </svg>\n  );\n}\n\nexport default SvgNext;\n","import * as React from \"react\";\n\nfunction SvgBookClose(props) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\" {...props}>\n      <defs>\n        <style>\n          {\n            \".bookClose_svg__cls-3{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}\"\n          }\n        </style>\n      </defs>\n      <g\n        id=\"bookClose_svg__\\uB808\\uC774\\uC5B4_2\"\n        data-name=\"\\uB808\\uC774\\uC5B4 2\"\n      >\n        <g\n          id=\"bookClose_svg__\\uB808\\uC774\\uC5B4_1-2\"\n          data-name=\"\\uB808\\uC774\\uC5B4 1\"\n        >\n          <path fill=\"none\" d=\"M0 0h48v48H0z\" opacity={0.2} />\n          <path\n            className=\"bookClose_svg__cls-3\"\n            d=\"M37.12 3H10.88a3 3 0 00-.43 0A1.71 1.71 0 009.1 4.11a1.87 1.87 0 00-.1.59v29.18c0 1 0 .94 1.88 1.88l18 9a1.8 1.8 0 002.6-1.2 3 3 0 000-.31v-7.58h5.62A1.88 1.88 0 0039 33.8V4.87A1.88 1.88 0 0037.12 3z\"\n          />\n          <path\n            className=\"bookClose_svg__cls-3\"\n            d=\"M31.5 35.67V14.84a2 2 0 00-1.1-1.78L10.45 3\"\n          />\n        </g>\n      </g>\n    </svg>\n  );\n}\n\nexport default SvgBookClose;\n","import * as React from \"react\";\n\nfunction SvgBookOpen(props) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\" {...props}>\n      <defs>\n        <style>\n          {\n            \".bookOpen_svg__cls-3{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}\"\n          }\n        </style>\n      </defs>\n      <g\n        id=\"bookOpen_svg__\\uB808\\uC774\\uC5B4_2\"\n        data-name=\"\\uB808\\uC774\\uC5B4 2\"\n      >\n        <g\n          id=\"bookOpen_svg__\\uB808\\uC774\\uC5B4_1-2\"\n          data-name=\"\\uB808\\uC774\\uC5B4 1\"\n        >\n          <path fill=\"none\" d=\"M0 0h48v48H0z\" opacity={0.2} />\n          <path\n            className=\"bookOpen_svg__cls-3\"\n            d=\"M4 6.5a27.24 27.24 0 0120 1v34a27.24 27.24 0 00-20-1zM24 7.5a27.24 27.24 0 0120-1v34a27.24 27.24 0 00-20 1\"\n          />\n        </g>\n      </g>\n    </svg>\n  );\n}\n\nexport default SvgBookOpen;\n","import * as React from \"react\";\n\nfunction SvgClose(props) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\" {...props}>\n      <defs>\n        <style>\n          {\n            \".close_svg__cls-3{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}\"\n          }\n        </style>\n      </defs>\n      <g id=\"close_svg__\\uB808\\uC774\\uC5B4_2\" data-name=\"\\uB808\\uC774\\uC5B4 2\">\n        <g\n          id=\"close_svg__\\uB808\\uC774\\uC5B4_1-2\"\n          data-name=\"\\uB808\\uC774\\uC5B4 1\"\n        >\n          <path fill=\"none\" d=\"M0 0h48v48H0z\" opacity={0.2} />\n          <path className=\"close_svg__cls-3\" d=\"M4 4l40 40M4 44L44 4\" />\n        </g>\n      </g>\n    </svg>\n  );\n}\n\nexport default SvgClose;\n","import * as React from \"react\";\n\nfunction SvgDown(props) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\" {...props}>\n      <g data-name=\"\\uB808\\uC774\\uC5B4 2\">\n        <g data-name=\"\\uB808\\uC774\\uC5B4 1\">\n          <path fill=\"none\" d=\"M0 0h48v48H0z\" opacity={0.2} />\n          <path\n            d=\"M8.33 15.82l14.32 20.46a1.63 1.63 0 002.7 0l14.32-20.46A1.78 1.78 0 0038.32 13H9.68a1.78 1.78 0 00-1.35 2.82z\"\n            stroke=\"#000\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n          />\n        </g>\n      </g>\n    </svg>\n  );\n}\n\nexport default SvgDown;\n","import * as React from \"react\";\n\nfunction SvgScrollHorizontal(props) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\" {...props}>\n      <defs>\n        <style>\n          {\n            \".scrollHorizontal_svg__cls-3{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}\"\n          }\n        </style>\n      </defs>\n      <g\n        id=\"scrollHorizontal_svg__\\uB808\\uC774\\uC5B4_2\"\n        data-name=\"\\uB808\\uC774\\uC5B4 2\"\n      >\n        <g\n          id=\"scrollHorizontal_svg__\\uB808\\uC774\\uC5B4_1-2\"\n          data-name=\"\\uB808\\uC774\\uC5B4 1\"\n        >\n          <path fill=\"none\" d=\"M0 0h48v48H0z\" opacity={0.2} />\n          <circle\n            className=\"scrollHorizontal_svg__cls-3\"\n            cx={24}\n            cy={24}\n            r={5}\n          />\n          <path\n            className=\"scrollHorizontal_svg__cls-3\"\n            d=\"M3 24l12-12M3 24l12 12M45 24L33 12M45 24L33 36\"\n          />\n        </g>\n      </g>\n    </svg>\n  );\n}\n\nexport default SvgScrollHorizontal;\n","import * as React from \"react\";\n\nfunction SvgScrollVertical(props) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\" {...props}>\n      <defs>\n        <style>\n          {\n            \".scrollVertical_svg__cls-3{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}\"\n          }\n        </style>\n      </defs>\n      <g\n        id=\"scrollVertical_svg__\\uB808\\uC774\\uC5B4_2\"\n        data-name=\"\\uB808\\uC774\\uC5B4 2\"\n      >\n        <g\n          id=\"scrollVertical_svg__\\uB808\\uC774\\uC5B4_1-2\"\n          data-name=\"\\uB808\\uC774\\uC5B4 1\"\n        >\n          <path fill=\"none\" d=\"M0 0h48v48H0z\" opacity={0.2} />\n          <circle className=\"scrollVertical_svg__cls-3\" cx={24} cy={24} r={5} />\n          <path\n            className=\"scrollVertical_svg__cls-3\"\n            d=\"M24 3l12 12M24 3L12 15M24 45l12-12M24 45L12 33\"\n          />\n        </g>\n      </g>\n    </svg>\n  );\n}\n\nexport default SvgScrollVertical;\n","import * as React from \"react\";\n\nfunction SvgSearch(props) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\" {...props}>\n      <defs>\n        <style>\n          {\n            \".search_svg__cls-3{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}\"\n          }\n        </style>\n      </defs>\n      <g id=\"search_svg__\\uB808\\uC774\\uC5B4_2\" data-name=\"\\uB808\\uC774\\uC5B4 2\">\n        <g\n          id=\"search_svg__\\uB808\\uC774\\uC5B4_1-2\"\n          data-name=\"\\uB808\\uC774\\uC5B4 1\"\n        >\n          <path fill=\"none\" d=\"M0 0h48v48H0z\" opacity={0.2} />\n          <circle className=\"search_svg__cls-3\" cx={17} cy={17} r={14} />\n          <path className=\"search_svg__cls-3\" d=\"M44 44L27 27\" />\n        </g>\n      </g>\n    </svg>\n  );\n}\n\nexport default SvgSearch;\n","import styled from 'styled-components'\n// icons\nimport { PrevIcon, NextIcon } from 'lib/svg'\n// lib\nimport * as styles from 'lib/styles/styles'\n\nconst MoveBtn = ({ type, onClick }: Props) => {\n  const Icon = type === \"PREV\"\n    ? PrevIcon\n    : NextIcon;\n  \n  const msg = type === \"PREV\"\n    ? \"이전 페이지\"\n    : \"다음 페이지\";\n\n  return (\n    <Container onClick={onClick} title={msg}>\n      <Content>\n        <Icon />\n      </Content>\n    </Container>\n  );\n}\n\nconst Container = styled.button`\n  min-width: 60px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  outline: none;\n\n  &:focus, &:hover {\n    filter: invert(40%) sepia(85%) saturate(1256%) hue-rotate(210deg) brightness(113%) contrast(101%);\n  }\n`;\n\nconst Content = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: .1s ${styles.transition};\n\n  & > svg {\n    width: 18px;\n    height: 18px;\n  }\n`;\n\ninterface Props {\n  type: \"PREV\" | \"NEXT\"\n  onClick: () => void;\n}\n\nexport default MoveBtn;","// components\nimport Wrapper from 'components/footer/Wrapper'\nimport Item from 'components/footer/Item'\nimport MoveBtn from 'components/footer/MoveBtn'\n\n\nconst Footer = ({ title, nowPage, totalPage, onPageMove }: Props) => {\n  return (\n    <Wrapper>\n      <MoveBtn type=\"PREV\" onClick={() => onPageMove(\"PREV\")} />\n      <Item text={title} />\n      <Item text={`${nowPage} / ${totalPage}`} />\n      <MoveBtn type=\"NEXT\" onClick={() => onPageMove(\"NEXT\")} />\n    </Wrapper>\n  );\n}\n\ninterface Props {\n  title: string;\n  nowPage: number;\n  totalPage: number;\n  onPageMove: (type: \"PREV\" | \"NEXT\") => void;\n}\n\nexport default Footer","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\n// icons\nimport { CloseIcon } from 'lib/svg'\n\nconst CloseBtn = ({ onClick }: Props) => {\n  return (\n    <Btn onClick={onClick}>\n      <Icon />\n    </Btn>\n  );\n}\n\nconst Btn = styled.button`\n  position: relative;\n  height: 100%;\n  padding: 0 24px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: .1s ${styles.transition};\n  outline: none;\n\n  &:focus, &:hover {\n    filter: invert(40%) sepia(85%) saturate(1256%) hue-rotate(210deg) brightness(113%) contrast(101%);\n  }\n`;\n\nconst Icon = styled(CloseIcon)`\n  width: 18px;\n  height: 18px;\n`;\n\ninterface Props {\n  onClick: () => void;\n}\n\nexport default CloseBtn;","import React from 'react'\nimport styled from 'styled-components'\n// components\nimport CloseBtn from 'components/sideMenu/CloseBtn'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport zIndex from 'lib/styles/zIndex'\nimport palette from 'lib/styles/palette'\n\nconst Wrapper = ({ title, show, onClose, children }: Props, ref: any) => {\n  return (\n    <Container show={show} ref={ref}>\n      <Header>\n        <span>{title}</span>\n        <CloseBtn onClick={onClose} />\n      </Header>\n      {children}\n    </Container>\n  )\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  width: 340px;\n  max-width: 95vw;\n  height: 100vh;\n  top: 0;\n  right: 0;\n  z-index: ${zIndex.menu};\n  box-shadow: -4px 0 8px 0 rgba(0,0,0,.16);\n  background-color: ${palette.white};\n  border-radius: 16px 0 0 16px;\n  transform: ${({ show }: { show: boolean }) => show \n    ? `translateX(0px) scale(1)`\n    : `translateX(420px) scale(.9)`\n  };\n  transition: .4s ${styles.transition};\n  overflow-y: auto;\n  ${styles.scrollbar()};\n`;\n\nconst Header = styled.div`\n  width: 100%;\n  height: 64px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding-top: 4px;\n\n  & > span {\n    padding-left: 24px;\n    font-size: 21px;\n    font-weight: 600;\n  }\n`;\n\ninterface Props {\n  title: string;\n  show: boolean;\n  onClose: () => void;\n  children?: React.ReactNode;\n}\n\nexport default React.forwardRef(Wrapper)","import styled from 'styled-components'\n\nconst BookInfo = ({src=\"\", title ,publisher, author}: Props) => {\n  return (\n    <Container>\n      <BookImg src={src} alt={title} />\n      <BookContent>\n        <Title>{title}</Title>\n        <Info>{publisher}</Info>\n        <Info>{author}</Info>\n      </BookContent>\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  display: flex;\n  padding: 24px;\n`;\n\nconst BookImg = styled.img`\n  margin-right: 12px;\n  width: 44%;\n  min-width: 120px;\n  border-radius: 4px;\n  background: #eee;\n`;\n\nconst BookContent = styled.div`\n  flex-grow: 1;\n`;\n\nconst Title = styled.div`\n  font-weight: 500;\n  margin-bottom: 4px;\n`;\n\nconst Info = styled.div`\n  font-size: 14px;\n  margin-bottom: 4px;\n`;\n\ninterface Props {\n  src: string;\n  title: string;\n  publisher: string;\n  author: string;\n}\n\nexport default BookInfo","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport palette from 'lib/styles/palette'\n\nconst NavItem = ({ message, onClick }: Props) => {\n  return (\n    <Content onClick={onClick}>\n      <span>{message}</span>\n    </Content>\n  );\n}\n\nconst Content = styled.button`\n  width: 100%;\n  height: 48px;\n  box-sizing: border-box;\n  padding: 12px 24px;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  background-color: ${palette.gray0};\n  outline: none;\n  \n  & > span {\n    transition: .2s ${styles.transition};\n    font-size: 14px;\n  }\n\n  &:focus, &:hover {\n    & > span {\n      color: ${palette.blue3};\n      margin-left: 12px;\n    }\n  }\n\n  &:last-child {\n    margin-bottom: 32px;\n  }\n`;\n\ninterface Props {\n  message: string;\n  onClick: () => void;\n}\n\nexport default NavItem","import React from 'react'\nimport { useSelector } from 'react-redux'\n// components\nimport Wrapper from 'components/sideMenu/Wrapper'\nimport BookInfo from 'components/nav/BookInfo'\nimport NavItem from 'components/nav/NavItem'\n// types\nimport { RootState } from 'slices'\nimport Book from 'types/book'\nimport Toc from 'types/toc'\nimport { MenuControl } from 'lib/hooks/useMenu'\n\nconst Nav = ({ control, onToggle, onLocation }: Props, ref: any) => {\n  const book = useSelector<RootState, Book>(state => state.book.book);\n  const bookToc = useSelector<RootState, Toc[]>(state => state.book.toc);\n  \n  /** Click nav item */\n  const onClickItem = (loc: string) => {\n    onLocation(loc);\n    onToggle();\n  }\n\n  const Tocs = bookToc.map((t, idx) => \n    <NavItem key={idx}\n             message={t.label}\n             onClick={() => onClickItem(t.href)} />\n  );\n  \n  \n  return (<>\n    {control.display && <Wrapper title=\"Contents\"\n                                 show={control.open}\n                                 onClose={onToggle}\n                                 ref={ref}>\n      <BookInfo \n        src={book.coverURL}\n        title={book.title}\n        publisher={book.publisher}\n        author={book.author} \n      />\n      {Tocs}\n    </Wrapper>}\n  </>);\n}\n\ninterface Props {\n  control: MenuControl;\n  onToggle: () => void;\n  onLocation: (loc: string) => void;\n}\n\nexport default React.forwardRef(Nav)","import styled from 'styled-components'\n\nconst Wrapper = styled.div`\n  box-sizing: border-box;\n  padding: 24px;\n`;\n\nexport default Wrapper","import styled from 'styled-components'\n\nconst OptionWrapper = styled.div`\n  margin-bottom: 24px;\n`;\n\nexport default OptionWrapper","import styled from 'styled-components'\n\nconst OptionTitle = styled.div`\n  font-size: 14px;\n  font-weight: 500;\n  margin-bottom: 16px;\n`;\n\nexport default OptionTitle","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport palette from 'lib/styles/palette'\n// icons\nimport { DownIcon } from 'lib/svg'\n\nconst DropdownValue = ({ value, isDropdown, onClick }: Props) => {\n  return (\n    <Container \n      onClick={onClick}\n      isDropdown={isDropdown}\n      title=\"Select font\"\n    >\n      <Content>{value}</Content>\n      <Icon isDropdown={isDropdown}>\n        <DownIcon />\n      </Icon>\n    </Container>\n  );\n}\n\nconst Container = styled.button<{isDropdown: boolean}>`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  position: relative;\n  width: 100%;\n  height: 40px;\n  background-color: ${palette.white};\n  border: ${({isDropdown}) => isDropdown\n    ? `2px solid ${palette.blue3}`\n    : `2px solid ${palette.gray1}`\n  };\n  border-radius: ${({isDropdown}) => isDropdown\n    ? \"20px 20px 0 0\"\n    : \"20px\"\n  };\n  box-sizing: border-box;\n  padding: 0px 16px;\n  cursor: pointer;\n  z-index: 4;\n  transition: .1s ${styles.transition};\n  text-align: left;\n  outline: none;\n\n  &:hover, &:focus {\n    border: 2px solid ${palette.blue3};\n\n    & > div {\n      opacity: 1;\n      filter: invert(40%) sepia(85%) saturate(1256%) hue-rotate(210deg) brightness(113%) contrast(101%);\n    }\n  }\n`;\n\nconst Content = styled.span`\n  flex-grow: 1;\n  margin-right: 16px;\n  font-size: 14px;\n`;\n\nconst Icon = styled.div<{isDropdown: boolean}>`\n  display: flex;\n  width: 12px;\n  height: 12px;\n  opacity: .3;\n  \n  & > svg {\n    transform-origin: center;\n    transform: ${({isDropdown}) => isDropdown\n      ? 'rotate(180deg)'\n      : 'rotate(0deg)'\n    };\n  }\n`;\n\ninterface Props {\n  value: string;\n  isDropdown: boolean;\n  onClick: (e: any) => void;\n}\n\nexport default DropdownValue","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport palette from 'lib/styles/palette'\n\nconst DropdownItemWrapper = ({ show, children }: Props) => {\n  return <Container show={show}>{children}</Container>\n}\n\nconst Container = styled.div<{show: boolean}>`\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: 100%;\n  max-height: 200px;\n  overflow-y: auto;\n  box-sizing: border-box;\n  padding: 0 0 16px 0;\n  background-color: ${palette.white};\n  border: 2px solid ${palette.blue3};\n  z-index: 3;\n  border-radius: ${({show}) => show\n    ? '0 0 20px 20px'\n    : '20px'\n  };\n  transition: .4s ${styles.transition};\n  opacity: ${({show}) => show\n    ? '1'\n    : '0'\n  };\n  transform-origin: top;\n  transform: ${({show}) => show\n    ? 'translateY(-2px) scaleY(1);'\n    : 'translateY(-40px) scaleY(0);'\n  };\n  ${styles.scrollbar(6)}\n  ${({show}) => show\n    ? ''\n    : styles.noselect\n  };\n`;\n\ninterface Props {\n  show: boolean;\n  children: React.ReactElement[];\n}\n\nexport default DropdownItemWrapper","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\n\nconst DropdownItem = ({ value, onClick }: Props) => {\nconst text = value === \"Origin\" ? \"Original\" : value;\n\n  return <Container onClick={onClick}>{text}</Container>;\n}\n\nconst Container = styled.button`\n  width: 100%;\n  height: 40px;\n  box-sizing: border-box;\n  padding: 0 16px;\n  transition: .1s ${styles.transition};\n  font-size: 14px;\n  line-height: 40px;\n  cursor: pointer;\n  text-align: left;\n  outline: none;\n  \n  &:focus, &:hover {\n    background-color: rgba(0,0,0,.05);\n  }\n`;\n\ninterface Props {\n  value: string;\n  onClick: () => void;\n}\n\nexport default DropdownItem","import { useState, useEffect, useRef, useCallback } from 'react'\nimport styled from 'styled-components'\n// components\nimport OptionWrapper from 'components/option/OptionWrapper'\nimport OptionTitle from 'components/option/OptionTitle'\nimport DropdownValue from 'components/option/DropdownValue'\nimport DropdownItemWrapper from 'components/option/DropdownItemWrapper'\nimport DropdownItem from 'components/option/DropdownItem'\n// types\nimport { BookFontFamily } from 'types/book'\n\nconst Dropdown = ({\n  title,\n  defaultValue,\n  valueList,\n  onSelect\n}: Props) => {\n  const ref = useRef<HTMLDivElement | null>(null);\n  const [visible, setVisible] = useState<boolean>(false);\n  const value = defaultValue === \"Origin\" ? \"Original\" : defaultValue;\n  \n  /** Toggle dropdown */\n  const onToggle = useCallback(() => setVisible(!visible), [visible]);\n\n  /** Close dropdown */\n  const onClose = useCallback((e: any) => {\n    if (!ref || !ref.current) return;\n    if (![...e.path].includes(ref.current)) {\n      onToggle();\n    }\n  }, [ref, onToggle]);\n\n  const Items = valueList.map(font => \n    <DropdownItem key={font} value={font} onClick={() => {\n      onSelect(font);\n      onToggle();\n    }} />\n  );\n\n  /** Register dropdown close event */\n  useEffect(() => {\n    if (visible) {\n      document.addEventListener('click', onClose);\n    } else {\n      document.removeEventListener('click', onClose);\n    }\n    return () => {\n      document.removeEventListener('click', onClose);\n    }\n  }, [visible, onClose]);\n\n  return (\n    <OptionWrapper>\n      <OptionTitle>{title}</OptionTitle>\n\n      <DropdownWrapper ref={ref}>\n        <DropdownValue value={value} \n                       isDropdown={visible} \n                       onClick={onToggle} />\n        <DropdownItemWrapper show={visible}>\n          {Items}\n        </DropdownItemWrapper>\n      </DropdownWrapper>\n    </OptionWrapper>\n  );\n}\n\nconst DropdownWrapper = styled.div`\n  position: relative;\n`;\n\ninterface Props {\n  title: string;\n  defaultValue: BookFontFamily;\n  valueList: BookFontFamily[];\n  onSelect: (font: BookFontFamily) => void;\n}\n\nexport default Dropdown","import styled from 'styled-components'\n// lib\nimport palette from 'lib/styles/palette'\n\nconst OptionValue = styled.span<{ active: boolean }>`\n  display: inline-block;\n  font-size: 14px;\n  color: ${props => props.active\n    ? palette.blue3\n    : palette.gray4\n  };\n  margin-right: 8px;\n  width: 40px;\n  text-align: right;\n  line-height: 20px;\n`;\n\nexport default OptionValue","import styled from 'styled-components'\n// lib\nimport palette from 'lib/styles/palette'\nimport * as styles from 'lib/styles/styles'\n\nconst SliderValue = ({ \n  active, \n  minValue, \n  maxValue, \n  defaultValue, \n  step, \n  onChange \n}: Props) => {\n  const percentage = Math.round((defaultValue - minValue) / (maxValue - minValue) * 100);\n\n  return (<>\n    <Icon>-</Icon>\n    <SliderWrapper>\n      <SliderBackground />\n      <SliderBar \n        active={active}\n        percentage={percentage}\n      />\n      <Slider\n        type=\"range\" \n        min={minValue}\n        max={maxValue}\n        defaultValue={defaultValue}\n        step={step}\n        onChange={onChange}\n        active={active}\n        disabled={!active} />\n    </SliderWrapper>\n    <Icon>+</Icon>\n  </>);\n}\n\nconst SliderWrapper = styled.div`\n  flex-grow: 1;\n  display: flex;\n  position: relative;\n  width: auto;\n`;\n\nconst SliderBackground = styled.div`\n  position: absolute;\n  width: 100%;\n  height: 6px;\n  background-color: #eee;\n  border-radius: 6px;\n  z-index: 0;\n`;\n\nconst SliderBar = styled.div<{ percentage: number, active: boolean }>`\n  position: absolute;\n  top: 50%;\n  left: 0;\n  transform: translateY(-50%);\n  width: ${({ percentage }) => percentage + '%'};\n  height: 6px;\n  border-radius: 6px 0 0 6px;\n  background-color: ${props => props.active\n    ? palette.blue4\n    : palette.gray2\n  };\n\tz-index: 1;\n`;\n\nconst Slider = styled.input<{ active: boolean }>`\n  appearance: none;\n  width: 100%;\n  height: 6px;\n  background-color: transparent;\n  border-radius: 6px;\n  margin: 0;\n  z-index: 2;\n  outline: none;\n  \n  &::-webkit-slider-thumb {\n    appearance: none;\n    width: 18px;\n    height: 18px;\n    border-radius: 18px;\n    box-shadow: ${styles.boxShadow.regular};\n    background-color: white;\n    transition: .2s ${styles.transition};\n    transition-property: box-shadow, background-color;\n    border: ${props => props.active\n      ? `2px solid ${palette.blue3}`\n      : `2px solid ${palette.gray4}`\n    };\n    cursor: ${props => props.active\n        ? 'pointer'\n        : ''\n      };;\n\n    &:hover {\n      background-color: ${props => props.active\n        ? palette.blue1\n        : ''\n      };\n    }\n\n    &:active {\n      box-shadow: none;\n      background-color: ${props => props.active\n        ? palette.blue3\n        : ''\n      };\n    }\n  }\n\n  &:focus::-webkit-slider-thumb {\n    box-shadow: none;\n    background-color: ${palette.blue3};\n  }\n`;\n\nconst Icon = styled.span`\n  font-size: 12px;\n  font-weight: 500;\n  color: ${palette.gray4};\n  margin: 0 8px;\n  line-height: 20px;\n`;\n\ninterface Props {\n  active: boolean;\n  minValue: number;\n  maxValue: number;\n  defaultValue: number;\n  step: number;\n  onChange: (e: any) => void;\n}\n\nexport default SliderValue","import styled from 'styled-components'\n// components\nimport OptionWrapper from 'components/option/OptionWrapper'\nimport OptionTitle from 'components/option/OptionTitle'\nimport OptionValue from 'components/option/OptionValue'\nimport SliderValue from 'components/option/SliderValue'\n\nconst Slider = ({\n  active,\n  title,\n  minValue,\n  maxValue,\n  defaultValue,\n  step,\n  onChange\n}: Props) => {\n  const onChangeValue = (e: any) => {\n    if (!active) return;\n    onChange(e);\n  }\n  \n  \n  return (\n    <OptionWrapper>\n      <OptionTitle>{title}</OptionTitle>\n      \n      <SliderWrapper>\n        <OptionValue active={active}>{defaultValue}</OptionValue>\n        <SliderValue active={active}\n                     minValue={minValue}\n                     maxValue={maxValue}\n                     defaultValue={defaultValue}\n                     step={step}\n                     onChange={onChangeValue} />\n      </SliderWrapper>\n    </OptionWrapper>\n  );\n}\n\nconst SliderWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  height: 20px;\n`;\n\ninterface Props {\n  active: boolean;\n  title: string;\n  minValue: number;\n  maxValue: number;\n  defaultValue: number;\n  step: number;\n  onChange: (e: any) => void;\n}\n\nexport default Slider","import styled from 'styled-components'\n// components\nimport OptionWrapper from 'components/option/OptionWrapper'\nimport OptionTitle from 'components/option/OptionTitle'\n\nconst ControlIconBtnWrapper = ({ title, children }: Props) => {\n\treturn (\n\t\t<OptionWrapper>\n\t\t\t<OptionTitle>{title}</OptionTitle>\n\t\t\t<BtnWrapper>\n\t\t\t\t{children}\n\t\t\t</BtnWrapper>\n\t\t</OptionWrapper>\n\t);\n}\n\nconst BtnWrapper = styled.div`\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-around;\n\tpadding: 8px 0;\n`;\n\ninterface Props {\n\ttitle: string;\n\tchildren: any[]\n}\n\nexport default ControlIconBtnWrapper","import styled, { css } from 'styled-components'\n// icons\nimport { \n  ScrollHorizontalIcon,\n  ScrollVerticalIcon,\n  BookCloseIcon,\n  BookOpenIcon\n} from 'lib/svg'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport palette from 'lib/styles/palette'\n\nconst ControlIconBtn = ({ type, alt, active, isSelected, onClick }: Props) => {\n  let HeaderIcon = null;\n  switch (type) {\n    case \"ScrollVertical\":\n      HeaderIcon = ScrollVerticalIcon;\n      break;\n    case \"ScrollHorizontal\":\n      HeaderIcon = ScrollHorizontalIcon;\n      break;\n    case \"BookOpen\":\n      HeaderIcon = BookOpenIcon;\n      break;\n    case \"BookClose\":\n      HeaderIcon = BookCloseIcon;\n      break;\n  }\n  \n  const onClickBtn = () => {\n    if (active) onClick();\n  }\n\n  return (\n    <Btn \n      onClick={onClickBtn} \n      isSelected={isSelected}\n      active={active}\n      title={alt}\n    >\n      <Icon>\n        <HeaderIcon />\n      </Icon>\n    </Btn>\n  );\n}\n\nconst Btn = styled.button<{ isSelected: boolean, active: boolean }>`\n  position: relative;\n  height: 100%;\n  padding: 0 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 0;\n  transition: .3s ${styles.transition};\n  opacity: ${({active}) => active\n    ? '1'\n    : '.3'\n  };\n  cursor: ${({active}) => active\n    ? 'pointer'\n    : 'default'\n  };\n  outline: none;\n\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    margin: auto;\n    z-index: -1;\n    border-radius: 30px;\n    width: ${({isSelected}) => isSelected\n      ? '32px'\n      : '8px'\n    };\n    height: ${({isSelected}) => isSelected\n      ? '32px'\n      : '8px'\n    };\n    opacity: ${({active, isSelected}) => active && isSelected\n      ? '.7'\n      : '0'\n    };\n    transition: .1s ${styles.transition};\n    background-color: ${palette.blue1};\n  }\n\n  &:focus, &:hover {\n    ${({active}) => active\n      ? css`\n        &:before {\n          width: 32px;\n          height: 32px;\n          opacity: 1;\n        }\n      `\n      : \"\"\n    };\n    \n  }\n`;\n\nconst Icon = styled.div`\n  width: 16px;\n  height: 16px;\n\n  & > div, & > svg {\n    width: 16px;\n    height: 16px;\n  }\n`;\n\ntype HeaderIcon = \n  \"ScrollHorizontal\" |\n  \"ScrollVertical\" |\n  \"BookOpen\" |\n  \"BookClose\";\n\ninterface Props {\n  type: HeaderIcon;\n  alt: string;\n  active: boolean;\n  isSelected: boolean;\n  onClick: () => void;\n}\n\nexport default ControlIconBtn","import React from 'react'\nimport { useState, useEffect } from 'react'\n// components\nimport Wrapper from 'components/sideMenu/Wrapper'\nimport OptionLayout from 'components/option/Layout'\nimport OptionDropdown from 'components/option/Dropdown'\nimport OptionSlider from 'components/option/Slider'\nimport ControlIconBtnWrapper from 'components/option/ControlIconBtnWrapper'\nimport ControlIconBtn from 'components/option/ControlIconBtn'\n// types\nimport { BookStyle, BookFontFamily, BookFlow } from 'types/book'\nimport { MenuControl } from 'lib/hooks/useMenu'\nimport { BookOption } from 'types/book'\n\nconst Option = ({ \n  control, \n  bookStyle,\n  bookOption,\n  bookFlow,\n  onToggle, \n  emitEvent,\n  onBookStyleChange,\n  onBookOptionChange\n}: Props, ref: any) => {\n  const [fontFamily, setFontFamily] = useState<BookFontFamily>(bookStyle.fontFamily);\n  const [fontSize, setFontSize] = useState<number>(bookStyle.fontSize);\n  const [lineHeight, setLineHeight] = useState<number>(bookStyle.lineHeight);\n  const [marginHorizontal, setMarginHorizontal] = useState<number>(bookStyle.marginHorizontal);\n  const [marginVertical, setMarginVertical] = useState<number>(bookStyle.marginVertical);\n  const [isScrollHorizontal, setIsScrollHorizontal] = useState<boolean>(true);\n  const [viewType, setViewType] = useState<ViewType>({\n    active: true,\n    spread: true\n  });\n\n\n  /** Change font family */\n  const onSelectFontFamily = (font: BookFontFamily) => setFontFamily(font);\n\n  /** Change font style and layout */\n  const onChangeSlider = (type: SliderType, e: any) => {\n    if (!e || !e.target) return;\n    switch (type) {\n      case \"FontSize\":\n        setFontSize(e.target.value);\n        break;\n      case \"LineHeight\":\n        setLineHeight(e.target.value);\n        break;\n      case \"MarginHorizontal\":\n        setMarginHorizontal(e.target.value);\n        break;\n      case \"MarginVertical\":\n        setMarginVertical(e.target.value);\n        break;\n      default:\n        break;\n    }\n  }\n\n  /** \n   * Select view direction\n   * @param type Direction\n   */\n   const onClickDirection = (type: \"Horizontal\" | \"Vertical\") => {\n    if (type === \"Horizontal\") {\n      setIsScrollHorizontal(true);\n      setViewType({ ...viewType, active: true });\n      onBookOptionChange({\n        ...bookOption,\n        flow: \"paginated\"\n      });\n    } else {\n      setIsScrollHorizontal(false);\n      setViewType({ ...viewType, active: false });\n      onBookOptionChange({\n        ...bookOption,\n        flow: \"scrolled-doc\"\n      });\n    }\n  }\n\n  /**\n   * Select isSpread\n   * @param isSpread Whether spread view \n   */\n  const onClickViewType = (isSpread: boolean) => {\n    if (isSpread) {\n      setViewType({ ...viewType, spread: true });\n      onBookOptionChange({\n        ...bookOption,\n        spread: \"auto\"\n      });\n    } else {\n      setViewType({ ...viewType, spread: false });\n      onBookOptionChange({\n        ...bookOption,\n        spread: \"none\"\n      });\n    }\n  }\n\n\n  /* Save userdata */\n  // TODO Fix the infinite re-rendering issue, when inlcude `onBookStyleChange` to dependencies array.\n  /* eslint-disable */\n  useEffect(() => {\n    const timer = window.setTimeout(() => { \n      onBookStyleChange({\n        fontFamily,\n        fontSize,\n        lineHeight,\n        marginHorizontal,\n        marginVertical\n      });\n    }, 250);\n\n    return () => window.clearTimeout(timer);\n  }, [\n    fontFamily, \n    fontSize, \n    lineHeight, \n    marginHorizontal, \n    marginVertical\n  ]);\n  /* eslint-enable */\n\n  /** Re-register close event, when after set */\n  useEffect(() => emitEvent(), [bookStyle, emitEvent]);\n\n  \n  return (<>\n    {control.display && <Wrapper title=\"Setting\"\n                                 show={control.open}\n                                 onClose={onToggle}\n                                 ref={ref}>\n      <OptionLayout>\n        <ControlIconBtnWrapper title=\"View Direction\">\n          <ControlIconBtn type=\"ScrollHorizontal\"\n                          alt=\"Horizontal View\"\n                          active={true}\n                          isSelected={isScrollHorizontal}\n                          onClick={() => onClickDirection(\"Horizontal\")} />\n          <ControlIconBtn type=\"ScrollVertical\" \n                          alt=\"Vertical View\"\n                          active={true}\n                          isSelected={!isScrollHorizontal}\n                          onClick={() => onClickDirection(\"Vertical\")} />\n        </ControlIconBtnWrapper>\n        <ControlIconBtnWrapper title=\"View Spread\">\n          <ControlIconBtn type=\"BookOpen\" \n                          alt=\"Two Page View\"\n                          active={viewType.active}\n                          isSelected={viewType.spread}\n                          onClick={() => onClickViewType(true)} />\n          <ControlIconBtn type=\"BookClose\" \n                          alt=\"One Page View\"\n                          active={viewType.active}\n                          isSelected={!viewType.spread}\n                          onClick={() => onClickViewType(false)} />\n        </ControlIconBtnWrapper>\n        <OptionDropdown title=\"Font\"\n                        defaultValue={fontFamily}\n                        valueList={[\"Origin\", \"Roboto\"]}\n                        onSelect={onSelectFontFamily} />\n        <OptionSlider active={true}\n                      title=\"Size\"\n                      minValue={8}\n                      maxValue={36}\n                      defaultValue={fontSize}\n                      step={1}\n                      onChange={(e) => onChangeSlider(\"FontSize\", e)} />\n        <OptionSlider active={true}\n                      title=\"Line height\"\n                      minValue={1}\n                      maxValue={3}\n                      defaultValue={lineHeight}\n                      step={0.1}\n                      onChange={(e) => onChangeSlider(\"LineHeight\", e)} />\n        <OptionSlider active={true}\n                      title=\"Horizontal margin\"\n                      minValue={0}\n                      maxValue={100}\n                      defaultValue={marginHorizontal}\n                      step={1}\n                      onChange={(e) => onChangeSlider(\"MarginHorizontal\", e)} />\n        <OptionSlider active={bookFlow === \"paginated\"}\n                      title=\"Vertical margin\"\n                      minValue={0}\n                      maxValue={100}\n                      defaultValue={marginVertical}\n                      step={1}\n                      onChange={(e) => onChangeSlider(\"MarginVertical\", e)} />\n      </OptionLayout>\n    </Wrapper>}\n  </>);\n}\n\ninterface Props {\n  control: MenuControl;\n  bookStyle: BookStyle;\n  bookOption: BookOption;\n  bookFlow: BookFlow;\n  onToggle: () => void;\n  emitEvent: () => void;\n  onBookStyleChange: (bookStyle: BookStyle) => void;\n  onBookOptionChange: (bookOption: BookOption) => void;\n}\n\ntype SliderType = \"FontSize\" \n  | \"LineHeight\" \n  | \"MarginHorizontal\" \n  | \"MarginVertical\";\n\ntype ViewType = {\n  active: boolean,\n  spread: boolean\n}\n\nexport default React.forwardRef(Option)","import styled from 'styled-components'\n// lib\nimport palette from 'lib/styles/palette'\nimport * as styles from 'lib/styles/styles'\n\nconst Wrapper = styled.button`\n  padding: 16px 24px;\n  display: flex;\n  align-items: flex-start;\n  justify-content: flex-start;\n  background-color: ${palette.gray0};\n  transition: .1s ${styles.transition};\n  cursor: pointer;\n  outline: none;\n  text-align: left;\n  border-bottom: 1px solid ${palette.gray1};\n  \n  &:nth-child(2) {\n    border-top: 1px solid ${palette.gray1};\n  }\n\n  & > div {\n    color: inherit;\n    flex-grow: 1;\n  }\n\n  &:hover > *, &:focus > * {\n    color: ${palette.blue3};\n  }\n`;\n\nexport default Wrapper","import styled from 'styled-components'\n\nconst Title = styled.div`\n  font-size: 14px;\n  font-weight: 600;\n  color: inherit;\n`;\n\nexport default Title","import styled from 'styled-components'\n\nconst Post = styled.div<{ color: string }>`\n  position: relative;\n  font-size: 14px;\n  margin-top: 16px;\n  padding: 8px;\n  box-sizing: border-box;\n\n  &::before {\n    content: '';\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    left: 0;\n    top: 0;\n    background-color: ${({ color }) => color};\n    opacity: .3;\n    border-radius: 8px;\n    mix-blend-mode: multiply;\n  }\n`;\n\nexport default Post","import styled from 'styled-components'\n// lib\nimport palette from 'lib/styles/palette'\n\nconst PageNum = ({ num }: Props) => {\n  return <Content>{num}p</Content>\n}\n\nconst Content = styled.span`\n  min-width: 32px;\n  margin-right: 16px;\n  font-size: 14px;\n  font-weight: 500;\n  color: ${palette.gray4};\n`;\n\ninterface Props {\n  num: number;\n}\n\nexport default PageNum","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\n// types\nimport Book from 'types/book'\nimport Page from 'types/page'\nimport Toc from 'types/toc'\nimport Highlight, { Color } from 'types/highlight'\n// lib\nimport palette from 'lib/styles/palette'\n\n\n/* \n\tInitial State\n*/\n\n/** 초기 Book 상태 */\nconst initialBook: Book = {\n\tcoverURL: '',\n\ttitle: '',\n\tdescription: '',\n\tpublished_date: '',\n\tmodified_date: '',\n\tauthor: '',\n\tpublisher: '',\n\tlanguage: ''\n}\n\n/** 초기 CurrentPage 상태 */\nconst initialCurrentLocation: Page = {\n\tchapterName: \"-\",\n\tcurrentPage: 0,\n\ttotalPage: 0,\n\tstartCfi: '',\n\tendCfi: '',\n\tbase: ''\n}\n\n/** 초기 색상표 상태 */\nconst initialColorList: Color[] = [\n\t{ name: 'Red', code: palette.red4 },\n\t{ name: 'Orange', code: palette.orange4 },\n\t{ name: 'Yellow', code: palette.yellow4 },\n\t{ name: 'Green', code: palette.green4 },\n\t{ name: 'Blue', code: palette.blue4 },\n\t{ name: 'Purple', code: palette.purple4 }\n]\n\nconst initialState: BookState = {\n\tbook: initialBook,\n\tcurrentLocation: initialCurrentLocation,\n\ttoc: [],\n\thighlights: [],\n\tcolorList: initialColorList,\n}\n\n\n/* \n\tSlice\n*/\nconst bookSlice = createSlice({\n\tname: 'book',\n\tinitialState,\n\treducers: {\n\t\t/** Book 갱신 @dispatch */\n\t\tupdateBook(state, action: PayloadAction<Book>) {\n\t\t\tstate.book = action.payload;\n\t\t},\n\t\t/** CurrentPage 갱신 @dispatch */\n\t\tupdateCurrentPage(state, action: PayloadAction<Page>) {\n\t\t\tstate.currentLocation = action.payload;\n\t\t},\n\t\t/** Book 초기화 @dispatch */\n\t\tclearBook(state) {\n\t\t\tstate.book = initialBook;\n\t\t},\n\t\t/** 목차 갱신 @dispatch */\n\t\tupdateToc(state, action: PayloadAction<Toc[]>) {\n\t\t\tstate.toc = action.payload;\n\t\t},\n\t\t/** 목차 초기화 @dispatch */\n\t\tclearToc(state) {\n\t\t\tstate.toc = [];\n\t\t},\n\t\t/** 하이라이트 추가 */\n\t\tpushHighlight(state, action: PayloadAction<Highlight>) {\n\t\t\tconst check = state.highlights.filter(h => h.key === action.payload.key);\n\t\t\tif (check.length > 0) return;\n\t\t\tstate.highlights.push(action.payload);\n\t\t},\n\t\t/** 하이라이트 갱신 */\n\t\tupdateHighlight(state, action: PayloadAction<Highlight>) {\n\t\t\tconst new_idx = action.payload.key;\n\t\t\tconst old_idx = state.highlights.map(h => h.key).indexOf(new_idx);\n\t\t\tstate.highlights.splice(old_idx, 1, action.payload);\n\t\t},\n\t\t/** 하이라이트 삭제 */\n\t\tpopHighlight(state, action: PayloadAction<string>) {\n\t\t\tconst idx = state.highlights.map(h => h.key).indexOf(action.payload);\n\t\t\tstate.highlights.splice(idx, 1);\n\t\t}\n\t}\n});\n\n\nexport interface BookState {\n\tbook: Book;\n\tcurrentLocation: Page;\n\ttoc: Toc[];\n\thighlights: Highlight[];\n\tcolorList: Color[];\n}\n\nexport const { \n\tupdateBook,\n\tclearBook,\n\tupdateCurrentPage,\n\tupdateToc,\n\tclearToc,\n\tpushHighlight,\n\tupdateHighlight,\n\tpopHighlight\n } = bookSlice.actions;\n \nexport default bookSlice.reducer","import { useDispatch } from 'react-redux'\n// components\nimport Wrapper from 'components/note/highlight/Wrapper'\nimport Title from 'components/note/highlight/Title'\nimport Post from 'components/note/highlight/Post'\nimport PageNum from 'components/note/highlight/PageNum'\n// slices\nimport { updateHighlight } from 'slices/book'\n// utils\nimport { cfiRangeSpliter } from 'lib/utils/commonUtil'\n// types\nimport HighlightType from 'types/highlight'\n\nconst Highlight = ({ \n  highlight, \n  onClick, \n  emitEvent, \n  viewerRef\n}: Props) => {\n  const dispatch = useDispatch();\n\n\n  /** 하이라이트 클릭 */\n  const onClickHighlight = () => {\n    if (!viewerRef.current) return;\n    \n    const now = new Date().toISOString();\n    dispatch(updateHighlight({\n      ...highlight,\n      accessTime: now\n    }));\n\n    const splitCfi = cfiRangeSpliter(highlight.cfiRange);\n    if (!splitCfi) return;\n\n    const { startCfi } = splitCfi;\n\n    viewerRef.current.setLocation(startCfi);\n\n    emitEvent();\n\n    const svgContainer = viewerRef.current.querySelector(\"svg\");\n    if (!svgContainer) return;\n\n    const targetSvg = svgContainer.querySelector(`g[data-epubcfi=\"${highlight.cfiRange}\"]`);\n    if (!targetSvg) return;\n\n    onClick(targetSvg.childNodes[0]);\n  }\n  \n  return (\n    <Wrapper onClick={onClickHighlight}>\n      <PageNum num={highlight.pageNum} />\n\n      <div>\n        <Title>{highlight.chpaterName}</Title>\n\n        <Post color={highlight.color}>{highlight.content}</Post>\n      </div>\n    </Wrapper>\n  );\n}\n\ninterface Props {\n  highlight: HighlightType;\n  onClick: (highlightNode: any) => void;\n  emitEvent: () => void;\n  viewerRef: any;\n}\n\nexport default Highlight","import styled from 'styled-components'\n\nconst Layout = styled.div`\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n  box-sizing: border-box;\n  padding: 24px 0;\n`;\n\nexport default Layout","import styled from 'styled-components'\n// lib\nimport palette from 'lib/styles/palette'\n\nconst MenuEmpty = ({ text }: Props) => {\n  return <Content>{text}</Content>;\n}\n\nconst Content = styled.div`\n  flex-grow: 1;\n  height: auto;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: ${palette.blue2};\n  font-size: 14px;\n`;\n\ninterface Props {\n  text: string;\n}\n\nexport default MenuEmpty","import React, { useState, useEffect } from 'react'\nimport { useSelector } from 'react-redux'\n// containers\nimport Highlight from 'containers/menu/commons/Highlight'\n// components\nimport Wrapper from 'components/sideMenu/Wrapper'\nimport LearningLayout from 'components/note/Layout'\nimport MenuEmpty from 'components/sideMenu/MenuEmpty'\n// types\nimport { RootState } from 'slices'\nimport HighlightType from 'types/highlight'\nimport { MenuControl } from 'lib/hooks/useMenu'\n\n\nconst Note = ({ \n  control, \n  onToggle, \n  onClickHighlight, \n  emitEvent,\n  viewerRef \n}: Props, ref: any) => {\n  const highlights = useSelector<RootState, HighlightType[]>(state => state.book.highlights);\n  const [highlightList, setHighlightList] = useState<any[]>([]);\n\n\n  /** Set highlight contents */\n  useEffect(() => {\n    const Items = highlights.map(h => <Highlight key={h.key} \n                                                 highlight={h}\n                                                 onClick={onClickHighlight} \n                                                 emitEvent={emitEvent}\n                                                 viewerRef={viewerRef} />\n    );\n    setHighlightList(Items); \n  }, [\n    viewerRef,\n    highlights,\n    onClickHighlight,\n    emitEvent,\n    setHighlightList\n  ]);\n\n\n  return (<>\n    {control.display && <Wrapper title=\"Highlight\"\n                                 show={control.open}\n                                 onClose={onToggle}\n                                 ref={ref} >\n      <LearningLayout>\n        {highlightList.length > 0\n          ? highlightList\n          : <MenuEmpty text=\"Empty highlights!\" />\n        }\n      </LearningLayout>\n    </Wrapper>}\n  </>);\n}\n\ninterface Props {\n  control: MenuControl;\n  onToggle: () => void;\n  onClickHighlight: (highlightNode: any) => void;\n  emitEvent: () => void;\n  viewerRef: any;\n}\n\nexport default React.forwardRef(Note)","import ViewerLayout from 'types/viewerLayout'\n\n/** Epub viewer layout size */\nconst viewerLayout: ViewerLayout = {\n  MIN_VIEWER_WIDTH: 300,  \n  MIN_VIEWER_HEIGHT: 300,\n  VIEWER_HEADER_HEIGHT: 64,\n  VIEWER_FOOTER_HEIGHT: 60,\n\tVIEWER_SIDEMENU_WIDTH: 0\n}\n\nexport const contextmenuWidth = 160;\n\nexport default viewerLayout","import styled, { css } from 'styled-components'\n// lib\nimport { contextmenuWidth } from 'lib/styles/viewerLayout'\nimport * as styles from 'lib/styles/styles'\nimport zIndex from 'lib/styles/zIndex'\n\nconst Wrapper = styled.div<Props>`\n  position: absolute;\n  left: ${({ x }) => window.innerWidth < x + contextmenuWidth\n    ? `${window.innerWidth - contextmenuWidth}px`\n    : `${x}px`\n  };\n  top: ${({ y }) => window.innerHeight < y + 40\n    ? `${window.innerHeight - 40}px`\n    : `${y}px`\n  };\n  width: ${({ width }) => width + 'px'};\n  height: ${({ height }) => height + 'px'};\n  box-sizing: border-box;\n  padding: ${({ width }) => width > 0\n    ? `4px`\n    : ``\n  };\n  border-radius: 8px;\n  background-color: rgba(0,0,0,.8);\n  box-shadow: ${styles.boxShadow.regular};\n  z-index: ${zIndex.menu};\n\n  & > div:first-child {\n    height: 100%;\n    overflow-y: auto;\n    ${styles.scrollbar(0)};\n  }\n\n  &::before {\n    display: ${({ width }) => width > 0\n      ? `black`\n      : `none`\n    };\n    content: \"\";\n    position: absolute;\n    left: 80px;\n    ${({ isReverse }) => isReverse\n      ? css`bottom: -16px;`\n      : css`top: -16px;`\n    }\n    transform: translateX(-8px);\n    border: 8px solid rgba(0,0,0,0);\n    ${({ isReverse }) => isReverse\n      ? css`border-top: 8px solid rgba(0,0,0,.8);`\n      : css`border-bottom: 8px solid rgba(0,0,0,.8);`\n    }\n    z-index: 1;\n  }\n`;\n\ninterface Props {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  isReverse: boolean;\n}\n\nexport default Wrapper","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport palette from 'lib/styles/palette'\n\nconst ColorItem = ({ name, color, onClick }: Props) => {\n  const onClickItem = (e: any) => {\n    onClick();\n    e.target.blur();\n  };\n\n  return (\n    <Wrapper onClick={onClickItem}>\n      <ColorWrapper>\n        <Color color={color} />\n      </ColorWrapper>\n      <Message>{name}</Message>\n    </Wrapper>\n  );\n}\n\nconst Wrapper = styled.button`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  background-color: rgba(0,0,0,0);\n  transition: .1s ${styles.transition};\n  outline: none;\n\n  &:hover, &:focus {\n    background-color: ${palette.blue3};\n\n    & > span {\n      color: #fff;\n    }\n  }\n`;\n\nconst ColorWrapper = styled.div`\n  width: 16px;\n  height: 16px;\n  border-radius: 16px;\n  background-color: #fff;\n  margin-right: 16px;\n`;\n\nconst Color = styled.div<{ color: string }>`\n  width: 16px;\n  height: 16px;\n  border-radius: 16px;\n  background-color: ${({ color }) => color};\n  opacity: .4;\n`;\n\nconst Message = styled.span`\n  width: 48px;\n  font-size: 14px;\n  color: #ddd;\n  line-height: 20px;\n`;\n\ninterface Props {\n  name: string;\n  color: string;\n  onClick: () => void;\n}\n\nexport default ColorItem","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport palette from 'lib/styles/palette'\n\nconst Item = ({ text, onClick }: Props) => {\n  return <Container onClick={onClick}>{text}</Container>;\n}\n\nconst Container = styled.button`\n  width: 100%;\n  height: 32px;\n  line-height: 32px;\n  text-align: center;\n  font-size: 14px;\n  color: #ccc;\n  transition: .1s ${styles.transition};\n  background-color: rgba(0,0,0,0);\n  border-radius: 6px;\n  cursor: pointer;\n  outline: none;\n\n  &:focus, &:hover {\n    color: #fff;\n    background-color: ${palette.red3};\n  }\n`;\n\ninterface Props {\n  text: string;\n  onClick: (e?: any) => void;\n}\n\nexport default Item","import { useState, useEffect, useCallback, useRef } from 'react'\nimport { useSelector } from 'react-redux'\n// components\nimport Wrapper from 'components/contextMenu/Wrapper'\nimport ColorItem from 'components/contextMenu/ColorItem'\nimport Item from 'components/contextMenu/Item'\n// utils\nimport { getParagraphCfi } from 'lib/utils/commonUtil'\n// slices\nimport { contextmenuWidth } from 'lib/styles/viewerLayout'\n// types\nimport { RootState } from 'slices'\nimport Highlight, { Color } from 'types/highlight'\nimport Selection from 'types/selection'\n\n\nconst ContextMenu = ({ \n  active,\n  viewerRef, \n  selection, \n  onAddHighlight,\n  onRemoveHighlight,\n  onUpdateHighlight, \n  onContextmMenuRemove\n}: Props) => {\n  const highlights = useSelector<RootState, Highlight[]>(state => state.book.highlights);\n  const colorList = useSelector<RootState, Color[]>(state => state.book.colorList);\n\n  const menuRef = useRef<HTMLDivElement | null>(null);\n\n  const [highlight, setHighlight] = useState<Highlight | null>(null);\n  \n  const [display, setDisplay] = useState<boolean>(false);\n  const [isEraseBtn, setIsEraseBtn] = useState<boolean>(false);\n  const [isReverse, setIsReverse] = useState<boolean>(false);\n  \n  const [height, setHeight] = useState<number>(0);\n  const [y, setY] = useState<number>(selection.y);\n\n  const ColorList = colorList.map(\n    color => <ColorItem key={color.code}\n                        name={color.name}\n                        color={color.code}\n                        onClick={selection.update\n                          ? () => onUpdateHighlight(highlight, color.code)\n                          : () => onAddHighlight(color.code)\n                        } />\n  );\n\n  \n  /** Remove highlight */\n  const onRemoveHighlight_ = useCallback(() => {\n    if (!highlight) return;\n\n    onRemoveHighlight(highlight.key, highlight.cfiRange);\n    onContextmMenuRemove();\n    \n    setIsEraseBtn(false);\n  }, [highlight, onRemoveHighlight, onContextmMenuRemove]);\n\n  /** \n   * Remove contextmenu\n   * @param e Mouse Event\n   * @param e.path\n   */\n  const onRemove = useCallback(({ path }: any) => {\n    if (!menuRef.current) return;\n\n    if ([...path].includes(menuRef.current)) return;\n    onContextmMenuRemove();\n  }, [menuRef, onContextmMenuRemove]);\n  \n  /** \n   * Arrow event\n   * @param e Keyboard Event\n   * @param e.key\n   */\n  const onKeyPress = useCallback(({ key }: any) => {\n    key && key === \"ArrowLeft\" && onContextmMenuRemove();\n    key && key === \"ArrowRight\" && onContextmMenuRemove();\n  }, [onContextmMenuRemove]);\n\n\n  /** Check whether the menu button is visible */\n  useEffect(() => {\n    if (!active) setIsEraseBtn(false);\n\n    const paragraphCfi = getParagraphCfi(selection.cfiRange);\n    if (!paragraphCfi) return;\n\n    const filtered = highlights.filter(highlight => highlight.key === paragraphCfi + selection.cfiRange);\n\n    if (!filtered.length) return;\n    const highlight_ = filtered[0];\n    setHighlight(highlight_);\n\n    if (selection.update) {\n      setIsEraseBtn(true);\n    } else {\n      setIsEraseBtn(false);\n    }\n  }, [\n    active,\n    highlights, \n    selection.cfiRange,\n    selection.update\n  ]);\n\n  /** Register contextmenu events */\n  useEffect(() => {\n    if (!viewerRef.current) return;\n    \n    const iframe = document.querySelector('iframe');\n    const node = iframe && iframe.contentWindow && iframe.contentWindow.document;\n    const scrolledTarget = viewerRef.current.querySelector('div');\n\n    if (active) {\n      setDisplay(true);\n      scrolledTarget && scrolledTarget.addEventListener('scroll', onContextmMenuRemove);\n      node && node.addEventListener('mousedown', onRemove);\n      node && node.addEventListener('keyup', onKeyPress);\n      document.addEventListener('mousedown', onRemove);\n      document.addEventListener('keyup', onKeyPress);\n    } else {\n      setDisplay(false);\n      scrolledTarget && scrolledTarget.removeEventListener('scroll', onContextmMenuRemove);\n      node && node.removeEventListener('mousedown', onRemove);\n      node && node.removeEventListener('keyup', onKeyPress);\n      document.removeEventListener('mousedown', onRemove);\n      document.removeEventListener('keyup', onKeyPress);\n    };\n\n    return () => {\n      node && node.removeEventListener('mousedown', onContextmMenuRemove);\n      node && node.removeEventListener('keyup', onKeyPress);\n      document.removeEventListener('keyup', onKeyPress);\n    }\n  }, [\n    viewerRef, \n    active,\n    onRemove,\n    onContextmMenuRemove, \n    onKeyPress\n  ]);\n\n  /** Set modified contextmenu height & whether menu is reverse */\n  useEffect(() => {\n    const menuPadding = 8;\n    const itemHeight = 32;\n    let itemCnt = ColorList.length;\n    \n    if (isEraseBtn) itemCnt += 1;\n    \n    const defaultHeight = itemCnt * itemHeight + menuPadding;\n    let y_ = selection.y;\n    const { innerHeight } = window;\n    \n    if (selection.y + defaultHeight > innerHeight) {\n      y_ = selection.y - selection.height - (defaultHeight);\n      if (y_ < 0) {\n        setHeight(defaultHeight + y_ - 8);\n        y_ = 8;\n      } else {\n        setHeight(defaultHeight);\n      }\n      setIsReverse(true);\n    } else {\n      setHeight(defaultHeight);\n      setIsReverse(false);\n    }\n\n    setY(y_);\n  }, [\n    selection.y, \n    selection.height, \n    ColorList, \n    isEraseBtn, \n    setHeight\n  ]);\n\n\n  return (<>\n    {display && <Wrapper x={selection.x} \n                         y={y} \n                         width={contextmenuWidth}\n                         height={height}\n                         isReverse={isReverse}\n                         ref={menuRef}>\n      <div>\n        {ColorList}\n        {isEraseBtn && <Item text=\"Remove\" onClick={onRemoveHighlight_} />}\n      </div>\n    </Wrapper>}\n  </>);\n}\n\ninterface Props {\n  active: boolean;\n  viewerRef: any;\n  selection: Selection;\n  onAddHighlight: (color: string) => void;\n  onRemoveHighlight: (key: string, cfiRange: string) => void;\n  onUpdateHighlight: (highlight: Highlight | null, color: string) => void;\n  onContextmMenuRemove: () => void;\n}\n\nexport default ContextMenu","import { keyframes } from 'styled-components';\n\nconst fadeIn = keyframes`\n\t0% { opacity: 0; }\n\t100% { opacity: 1;}\n`;\nconst fadeOut = keyframes`\n\t0% { opacity: 1; }\n\t100% { opacity: 0; }\n`;\nconst fadeInTop = keyframes`\n\t0% { opacity: 0; transform: translateY(-40px); }\n\t100% { opacity: 1; transform: translateY(0); }\n`;\nconst fadeOutTop = keyframes`\n\t0% { opacity: 1; transform: translateY(0); }\n\t100% { opacity: 0; transform: translateY(-40px); }\n`;\nconst fadeInBottom = keyframes`\n\t0% { opacity: 0; transform: translateY(40px); }\n\t100% { opacity: 1; transform: translateY(0); }\n`;\nconst fadeOutBottom = keyframes`\n\t0% { opacity: 1; transform: translateY(0); }\n\t100% { opacity: 0; transform: translateY(40px); }\n`;\nconst fadeInLeft = keyframes`\n\t0% { opacity: 0; transform: translateX(-40px); }\n\t100% { opacity: 1; transform: translateX(0); }\n`;\nconst fadeOutLeft = keyframes`\n\t0% { opacity: 1; transform: translateX(0); }\n\t100% { opacity: 0; transform: translateX(-40px); }\n`;\nconst fadeInRight = keyframes`\n\t0% { opacity: 0; transform: translateX(40px); }\n\t100% { opacity: 1; transform: translateX(0); }\n`;\nconst fadeOutRight = keyframes`\n\t0% { opacity: 1; transform: translateX(0); }\n\t100% { opacity: 0; transform: translateX(40px); }\n`;\nconst spin = keyframes`\n\tfrom { transform: rotate(0deg); }\n\tto { transform: rotate(360deg); }\n`;\n\nconst animations = {\n\tfadeIn,\n\tfadeOut,\n\tfadeInTop,\n\tfadeOutTop,\n\tfadeInBottom,\n\tfadeOutBottom,\n\tfadeInLeft,\n\tfadeOutLeft,\n\tfadeInRight,\n\tfadeOutRight,\n\tspin\n};\n\nexport default animations","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\nimport media from 'lib/styles/media'\nimport palette from 'lib/styles/palette'\nimport animations from 'lib/styles/animations'\n// types\nimport SnackbarType from 'types/snackbar'\n\nconst Snackbar = ({ onClick, text, type }: Props)=> {\n\treturn (\n\t  <Container onClick={onClick} type={type}>\n\t  \t<Content>\n\t  \t  <Message>{text}</Message>\n\t  \t</Content>\n\t  </Container>\n\t);\n}\n\nconst Container = styled.div<{ type: SnackbarType }>`\n\tposition: relative;\n\twidth: 320px;\n\theight: auto;\n\tmax-height: 800px;\n\tbackground-color: ${({ type }) => {\n\t\t\tif (type === 'SUCCESS') {\t\n\t\t\t\treturn palette.green4;\n\t\t\t} else if (type === 'WARNING') {\n\t\t\t\treturn palette.orange4;\n\t\t\t} else if (type === 'ERROR') {\n\t\t\t\treturn palette.red3;\n\t\t\t} else if (type === 'INFO') {\n\t\t\t\treturn palette.blue4;\n\t\t\t} else {\n\t\t\t\treturn palette.gray4;\n\t\t\t}\n\t\t}\n\t};\n\tbox-shadow: ${styles.boxShadow.regular};\n\tborder-radius: 4px;\n\tanimation: ${animations.fadeInBottom} .3s cubic-bezier(0.25,0.1,0.25,1),\n\t\t\t\t\t\t ${animations.fadeOutBottom} .5s cubic-bezier(0.25,0.1,0.25,1) 3.6s;\n\tcursor: pointer;\n\ttransition: .2s ${styles.transition};\n\t${styles.noselect};\n\n\t&:active {\n\t\ttransform: scale(.97, .97);\n\t}\n\n\t${media.small} {\n\t\tborder-radius: 0px;\n\t\twidth: 100%;\n\t\tmin-height: 1.8rem;\n\t}\n`;\n\nconst Content = styled.div`\n\tposition: relative;\n\tdisplay: flex;\n\twidth: 100%;\n\theight: auto;\n\tmin-height: 2rem;\n\tbox-sizing: border-box;\n\tpadding: 12px 20px;\n\n\t${media.small} {\n\t\tmin-height: 1.6rem;\n\t\tline-height: 1.6rem;\n\t}\n`;\n\nconst Message = styled.div`\n\tposition: relative;\n\tflex-grow: 1;\n\tcolor: white;\n\tfont-size: 14px;\n\twhite-space: pre-wrap;\n\tword-break: keep-all;\n\tvertical-align: top;\n`;\n\n\ninterface Props {\n\tonClick(e: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\n\ttext: string;\n\ttype: SnackbarType;\n}\n\nexport default Snackbar","import { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit'\n// types\nimport Snackbar from 'types/snackbar'\n\n\nconst RefEvent: number[] = [];\n\n\n/* \n\tThunks\n*/\nexport const newSnackbar = createAsyncThunk(\n\t'snackbar/newSnackbar',\n\tasync (\n\t\t{ text, type }: SnackbarState, \n\t\t{ dispatch }\n\t) => {\n\t\tif(RefEvent.length !== 0) {\n\t\t\tlet event = RefEvent.shift();\n\t\t\tclearTimeout(event);\n\t\t}\n\t\tdispatch(SnackbarSlice.actions.deleteSnackbar());\n\t\tawait setTimeout(function() {\n\t\t\tdispatch(SnackbarSlice.actions.appendSnackbar({ text, type: type ? type: \"INFO\" }));\n\t\t\tlet event = window.setTimeout(function() {\n\t\t\t\tdispatch(SnackbarSlice.actions.deleteSnackbar());\n\t\t\t}, 4000);\n\t\t\tRefEvent.push(event);\n\t\t}, 50);\n\t}\n);\n\n/* \n\tInitial State\n*/\n\nconst initialState: SnackbarState = {\n\ttext: \"\",\n\ttype: \"INFO\"\n}\n\n\n/* \n\tSlice\n*/\nconst SnackbarSlice = createSlice({\n\tname: 'snackbar',\n\tinitialState,\n\treducers: {\n\t\t/** 스낵바 갱신 @dispatch */\n\t\tappendSnackbar(state, action: PayloadAction<SnackbarState>) {\n\t\t\tstate.text = action.payload.text;\n\t\t\tstate.type = action.payload.type;\n\t\t},\n\t\t/** 스낵바 초기화 @dispatch */\n\t\tdeleteSnackbar(state) {\n\t\t\tstate.text = \"\";\n\t\t\tstate.type = \"INFO\"\n\t\t}\n\t}\n});\n\n\nexport interface SnackbarState {\n\ttext: string;\n\ttype: Snackbar;\n}\n\nexport const {\n\tappendSnackbar,\n\tdeleteSnackbar\n} = SnackbarSlice.actions\n\nexport default SnackbarSlice.reducer","import styled from 'styled-components'\nimport { useSelector, useDispatch } from 'react-redux'\n// components\nimport Snackbar from 'components/commons/Snackbar'\n// lib\nimport zIndex from 'lib/styles/zIndex'\nimport media from 'lib/styles/media'\n// slices\nimport { deleteSnackbar } from 'slices/snackbar'\n// types\nimport { RootState } from 'slices'\nimport { SnackbarState } from 'slices/snackbar'\n\n\nconst SnackbarWrapper = ()=> {\n  const dispatch = useDispatch();\n\tconst snackbar = useSelector<RootState, SnackbarState>(state => state.snackbar);\n\t\n\n\tconst onClick = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n\t\tif (e) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}\n\t\tdispatch(deleteSnackbar());\n\t};\n\n\t\n\treturn (\n\t\t<Container>\n\t\t\t{snackbar.text !== '' && <Snackbar onClick={onClick} \n                                         text={snackbar.text} \n                                         type={snackbar.type} />}\n\t\t</Container>\n\t);\n}\n\nconst Container = styled.div`\n\tposition: fixed;\n\ttop: 40px;\n\tright: 30px;\n\twidth: 320px;\n\theight: auto;\n\tz-index: ${zIndex.snackbar};\n\n\t${media.small} {\n\t\twidth: 100%;\n\t\ttop: initial;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tmargin: auto;\n\t}\n`;\n\nexport default SnackbarWrapper","import styled from 'styled-components'\n// lib\nimport * as styles from 'lib/styles/styles'\n\nconst ViewerWrapper = styled.div`\n  position: relative;\n  width: 100vw;\n  height: 100vh;\n  overflow-x: hidden;\n  display: flex;\n  flex-direction: column;\n  ${styles.scrollbar(0)};\n`;\n\nexport default ViewerWrapper","import { configureStore } from \"@reduxjs/toolkit\";\nimport { combineReducers } from 'redux'\n// reducers\nimport book from 'slices/book'\nimport snackbar from 'slices/snackbar'\n\n/**\n * 모든 리듀서가 결합된 Root 리듀서\n */\nconst reducer = combineReducers({\n\tbook,\n\tsnackbar\n});\n\nexport type RootState = ReturnType<typeof reducer>\n\n/**\n * 공통 Store\n */\nconst store = configureStore({\n\treducer,\t\n});\n\nexport default store","import { useState, useEffect, useCallback } from 'react';\n\n/**\n * Epub Reader 메뉴를 컨트롤 하는 hook\n * - control의 display를 Menu 생성/제거 플래그로 이용합니다.\n * - control의 show를 Animaton 플래그로 이용합니다.\n * - Menu 이외의 영역 클릭시 Close Event 발동\n *\n * @param ref DOM을 가지고 있는 useRef\n * @param delay 애니메이션 딜레이 시간(ms)\n * \n * @example\n * const Viewer = () => {\n *   const menuDelay = 300;\n * \n *   const ref = useRef<HTMLDivElement | null>(null);\n *   const [control, onToggle] = usemenu(ref, menuDelay);\n * \n *   return (<>\n *     <MenuOpenBtn onClick={onToggle} />\n *     <Menu control={control} onToggle={onToggle} ref={ref} />\n *   </>);\n * }\n * \n * const Menu = ({ control, onToggle }, ref) => {\n *   return (<>\n *     {control.display && <MenuWrapper show={control.show} \n *                                      delay={menuDelay}\n *                                      ref={ref}>\n *       <CloseBtn onClick={onToggle} />\n *     </MenuWrapper>}\n *   </>);\n * }\n * \n * const MenuWrapper = styled.div<{show: boolean; delay: boolean;}>`\n *   transform: ${({show}) => show\n *     ? \"translateX(0px)\"\n *     : \"translateX(420px)\"\n *   };\n *   transition: ${({delay}) => `${delay}ms ease`};\n * `;\n */\nfunction useMenu(ref: { current: any }, delay: number) {\n\tconst [eventSignal, setEventSignal] = useState<boolean>(true);\n\tconst [control, setControl] = useState<MenuControl>({\n\t\tdisplay: false,\n\t\topen: false\n\t});\n\t\n\n\t/** Menu 토글 */\n\tconst onToggle = useCallback(() => {\n\t\tlet event: any = null;\n\t\twindow.clearTimeout(event);\n\t\tif (!control.display) {\n\t\t\tsetControl({ display: true, open: false });\n\t\t\tevent = window.setTimeout(() => setControl({ display: true, open: true}), 0);\n\t\t} else {\n\t\t\tsetControl({ display: true, open: false });\n\t\t\tevent = window.setTimeout(() => setControl({ display: false, open: false }), delay - 50);\n\t\t}\n\t}, [control.display, delay]);\n\n\t/** \n\t * 메뉴 닫기 \n\t * - Event path에서 메뉴가 포함되어있지 않으면, 함수를 실행합니다.\n\t */\n  const onClose = useCallback((e: any) => {\n    if (!ref || !ref.current) return;\n    if (!e.path.includes(ref.current)) {\n\t\t\tonToggle();\n    }\n  }, [ref, onToggle]);\n\n\t/** \n\t * 이벤트 재등록\n\t * - '보기설정' 에서 rendition이 재 렌더링 될 때, 이벤트를 재등록하기 위한 함수\n\t * - Iframe 생성 시간 대기 [About 250ms]\n\t */\n\tconst emitEvent = useCallback(() => {\n\t\twindow.setTimeout(() => setEventSignal(true), 300);\n\t}, [setEventSignal]); \n\n\n  /** \n\t * 목차 닫기 이벤트 등록 \n\t * - Epub이 iframe으로 등록되므로, iframe에도 Event를 등록시켜줍니다.\n\t */\n  useEffect(() => {\n\t\tif (!eventSignal && !control.display) return;\n\t\t\n    const epubIframe = document.querySelector('iframe');\n\n\t\tif (control.display) {\n\t\t\tdocument.addEventListener('click', onClose);\n\t\t\tif (epubIframe && epubIframe.contentWindow) {\n\t\t\t\tepubIframe.contentWindow.document.addEventListener('click', onClose);\n\t\t\t}\n\t\t} else {\n\t\t\tdocument.removeEventListener('click', onClose);\n      if (epubIframe && epubIframe.contentWindow) {\n\t\t\t\tepubIframe.contentWindow.document.removeEventListener('click', onClose);\n      }\n\t\t}\n\n\t\tsetEventSignal(false);\n  \n    return () => {\n      document.removeEventListener('click', onClose);\n      if (epubIframe && epubIframe.contentWindow) {\n\t\t\t\tepubIframe.contentWindow.document.removeEventListener('click', onClose);\n      }\n    }\n  }, [control.display, onClose, eventSignal]);\n\n\treturn [control, onToggle, emitEvent] as const;\n}\n\nexport type MenuControl = {\n\tdisplay: boolean;\n\topen: boolean;\n}\n\nexport default useMenu","import React, { useState, useEffect, useCallback } from 'react'\nimport { useSelector, useDispatch } from 'react-redux'\n// slices\nimport { pushHighlight, popHighlight, updateHighlight } from 'slices/book'\nimport { newSnackbar } from 'slices/snackbar'\n// utils\nimport {  \n\tgetParagraphCfi,\n\tclashCfiRange, \n\tgetSelectionPosition,\n\tcompareCfi,\n\tcfiRangeSpliter,\n\tgetNodefromCfi\n} from 'lib/utils/commonUtil'\n// styles\nimport viewerLayout, { contextmenuWidth } from 'lib/styles/viewerLayout'\n// types\nimport { RootState } from 'slices'\nimport { BookStyle, BookFlow } from 'types/book'\nimport Page from 'types/page'\nimport Selection from 'types/selection'\nimport Highlight from 'types/highlight'\n\n\n/**\n * Epub Reader의 Highlight 관련 hook\n * - [selection]: 현재 selection의 정보\n * - [onSelection]: selection 적용 함수 (Iframe에 selection 이벤트로 등록해야 합니다.)\n * - [onClickHighlight]: highlight 클릭 함수\n * - [onAddHighlight] highlight 생성 함수\n * - [onRemoveHighlight]: highlight 제거 함수\n * - [onUpdateHighlight]: highlight 갱신 함수\n *\n * @param viewerRef Viewer에 등록된 가지고 있는 useRef\n * @param setIsContextMenu Contextmenu를 컨트롤 할 수 있는 useState 함수\n * \n * @example\n * const [isContextMenu, setIsContextMenu] = useState<boolean>(false);\n * \n * const { \n * \tselection, \n * \tonSelection, \n * \tonClickHighlight,\n * \tonRemoveHighlight\n * } = useSelection(viewerRef, setIsContextMenu);\n */\nconst useHighlight = (\n\tviewerRef: any, \n\tsetIsContextMenu: React.Dispatch<React.SetStateAction<boolean>>,\n\tbookStyle: BookStyle,\n\tbookFlow: BookFlow\n) => {\n\tconst dispatch = useDispatch();\n\tconst currentLocation = useSelector<RootState, Page>(state => state.book.currentLocation);\n\tconst highlights = useSelector<RootState, Highlight[]>(state => state.book.highlights);\n\n\tconst [selection, setSelection] = useState<Selection>({\n\t\tupdate: false,\n\t\tx: 0,\n\t\ty: 0,\n\t\theight: 0,\n\t\tcfiRange: '',\n\t\tcontent: ''\n\t});\n\t\n\n\t/** \n\t * Selection 발동 이벤트\n\t * @param cfiRange CfiRange\n\t * @return Whether event is success\n\t */\n\tconst onSelection = useCallback((cfiRange: string): boolean => {\n\t\tif (!viewerRef.current) return false;\n\n\t\tconst iframe = viewerRef.current.querySelector('iframe');\n\t\tif (!iframe) return false;\n\n\t\tconst iframeWin = iframe.contentWindow;\n\t\tif (!iframeWin) return false;\n\t\t\n\t\tconst filtered = highlights.filter(\n\t\t\thighlight => clashCfiRange(highlight.cfiRange, cfiRange)\n\t\t);\n\n\t\tif (filtered.length > 0) {\n\t\t\tdispatch(newSnackbar({\n        text: \"There are already registered highlights in your selection.\", \n        type: \"WARNING\" \n      }));\n\n\t\t\tiframeWin.getSelection().removeAllRanges();\n\t\t\treturn false;\n\t\t}\n\n\t\tconst position = getSelectionPosition(\n\t\t\tviewerRef.current,\n\t\t\tbookStyle,\n\t\t\tbookFlow,\n\t\t\tviewerLayout.MIN_VIEWER_WIDTH,\n\t\t\tviewerLayout.MIN_VIEWER_HEIGHT,\n\t\t\tviewerLayout.VIEWER_HEADER_HEIGHT,\n\t\t\tcontextmenuWidth\n\t\t);\n\t\tif (!position) return false;\n\n\t\tconst { x, y, height } = position;\n\n\t\tconst content = iframeWin.getSelection().toString().trim();\n\n\t\tif (content.length === 0) return false;\n\t\t\n\t\tsetSelection({ \n\t\t\tupdate: false,\n\t\t\tx, \n\t\t\ty,\n\t\t\theight,\n\t\t\tcfiRange,\n\t\t\tcontent\n\t\t});\n\t\t\n\t\treturn true;\n\t}, [\n\t\tdispatch, \n\t\tviewerRef,\n\t\thighlights, \n\t\tbookFlow, \n\t\tbookStyle,\n\t\tsetSelection\n\t]);\n\n\t/** Highlight 클릭 이벤트 */\n\tconst onClickHighlight = useCallback((highlightNode: HTMLElement) => {\n\t\tconst targetNode = highlightNode.parentElement;\n\t\tif (!targetNode) return;\n\n\t\tconst cfiRange = targetNode.dataset.epubcfi;\n\t\tif (!cfiRange) return;\n\n\t\tconst { x, y, width, height } = targetNode.getBoundingClientRect();\n\n\t\tsetSelection({ \n\t\t\tupdate: true,\n\t\t\tx: x + width / 2 - contextmenuWidth / 2, \n\t\t\ty: y + height,\n\t\t\theight,\n\t\t\tcfiRange,\n\t\t\tcontent: \"\"\n\t\t});\n\t}, [setSelection]);\n\n\t/** 하이라이트 생성 함수 */\n\tconst onAddHighlight = useCallback((color: string) => {\n    const paragraphCfi = getParagraphCfi(selection.cfiRange);\n    if (!paragraphCfi) return;\n    \n    const highlight: Highlight = {\n      key: paragraphCfi + selection.cfiRange,\n      accessTime: new Date().toISOString(),\n      createTime: new Date().toISOString(),\n      color,\n      paragraphCfi,\n      cfiRange: selection.cfiRange,\n      chpaterName: currentLocation.chapterName,\n      pageNum: currentLocation.currentPage,\n      content: selection.content\n    };\n\n    dispatch(pushHighlight(highlight));\n\n\t\tsetSelection({ ...selection, update: true });\n  }, [dispatch, selection, currentLocation]);\n\n\t/** \n   * 하이라이트 수정\n   * @param color 색상 Hex 코드\n   */\n\tconst onUpdateHighlight = useCallback((highlight: Highlight | null, color: string) => {\n\t\tif (!highlight) return;\n\n    dispatch(updateHighlight({\n      ...highlight,\n      color\n    }));\n  }, [dispatch]);\n\n\t/** \n\t * 하이라이트 제거 함수 \n\t * @param key 북마크 식별값\n\t */\n\t const onRemoveHighlight = useCallback((key: string, cfiRange: string) => {\n\t\tif (!viewerRef.current || !key) return;\n\n\t\tdispatch(popHighlight(key));\n\n\t\tdispatch(newSnackbar({\n\t\t\ttext: \"The highlight removed successful!\", \n\t\t\ttype: \"INFO\" \n\t\t}));\n\t\t\n\t\tviewerRef.current.offHighlight(cfiRange);\n\t}, [dispatch, viewerRef]);\n\n\n\t/**\n\t * 하이라이트 여부 확인\n\t * - 페이지 변경에 따른 하이라이트 확인 및 적용\n\t */\n\t useEffect(() => {\n\t\tif (!viewerRef.current) return;\n\n\t\tconst iframe = viewerRef.current.querySelector('iframe');\n\t\tif (!iframe) return;\n\n\t\tconst iframeWin = iframe.contentWindow;\n\t\tif (!iframeWin) return;\n\n\t\thighlights.forEach(highlight => {\n\t\t\tconst cfiRange = cfiRangeSpliter(highlight.cfiRange);\n\t\t\tif (!cfiRange) return;\n\n\t\t\tconst { startCfi } = cfiRange;\n\n\t\t\tif (compareCfi(currentLocation.startCfi, startCfi) < 1\n\t\t\t\t&& compareCfi(currentLocation.endCfi, startCfi) > -1) {\n\t\t\t\tconst node = getNodefromCfi(highlight.paragraphCfi);\n\t\t\t\tif (!node) return;\n\n\t\t\t\tviewerRef.current.onHighlight(\n\t\t\t\t\thighlight.cfiRange,\n\t\t\t\t\t(e: any) => {\n\t\t\t\t\t\tonClickHighlight(e.target);\n\t\t\t\t\t\tsetIsContextMenu(true);\n\t\t\t\t\t},\n\t\t\t\t\thighlight.color \n\t\t\t\t);\n\n\t\t\t\tiframeWin.getSelection().removeAllRanges();\n\t\t\t}\n\t\t});\n\t}, [\n\t\tdispatch,\n\t\tviewerRef, \n\t\tcurrentLocation, \n\t\thighlights, \n\t\tonRemoveHighlight,\n\t\tonClickHighlight,\n\t\tsetIsContextMenu\n\t]);\n\n\n\treturn { \n\t\tselection, \n\t\tonSelection, \n\t\tonClickHighlight,\n\t\tonAddHighlight,\n\t\tonRemoveHighlight,\n\t\tonUpdateHighlight\n\t};\n}\n\nexport default useHighlight;","import { useState, useRef } from 'react'\nimport { useSelector, useDispatch } from 'react-redux'\nimport { Provider } from 'react-redux'\n// containers\nimport Viewer from 'modules/reactViewer/ReactViewer'\nimport Header from 'containers/Header'\nimport Footer from 'containers/Footer'\nimport Nav from 'containers/menu/Nav'\nimport Option from 'containers/menu/Option'\nimport Learning from 'containers/menu/Note'\nimport ContextMenu from 'containers/commons/ContextMenu'\nimport Snackbar from 'containers/commons/Snackbar'\n// components\nimport ViewerWrapper from 'components/commons/ViewerWrapper'\nimport LoadingView from 'LoadingView'\n// slices\nimport store from 'slices'\nimport { updateBook, updateCurrentPage, updateToc } from 'slices/book'\n// hooks\nimport useMenu from 'lib/hooks/useMenu'\nimport useHighlight from 'lib/hooks/useHighlight'\n// styles\nimport 'lib/styles/readerStyle.css'\nimport viewerLayout from 'lib/styles/viewerLayout'\n// types\nimport { RootState } from 'slices'\nimport { ViewerRef } from 'types'\nimport Book, { BookStyle, BookOption } from 'types/book'\nimport Page from 'types/page'\nimport Toc from 'types/toc'\n\n\nconst Reader = ({ url, loadingView }: Props) => {\n  const dispatch = useDispatch();\n\tconst currentLocation = useSelector<RootState, Page>(state => state.book.currentLocation);\n  \n\tconst viewerRef = useRef<ViewerRef | null>(null);\n\tconst navRef = useRef<HTMLDivElement | null>(null);\n  const optionRef = useRef<HTMLDivElement | null>(null);\n  const learningRef = useRef<HTMLDivElement | null>(null);\n\n\tconst [isContextMenu, setIsContextMenu] = useState<boolean>(false);\n\t\n\tconst [bookStyle, setBookStyle] = useState<BookStyle>({\n    fontFamily: 'Origin',\n    fontSize: 18,\n    lineHeight: 1.4,\n    marginHorizontal: 15,\n    marginVertical: 5\n  });\n\n  const [bookOption, setBookOption] = useState<BookOption>({\n    flow: \"paginated\",\n    resizeOnOrientationChange: true,\n    spread: \"auto\"\n  });\n\n\tconst [navControl, onNavToggle] = useMenu(navRef, 300.);\n\tconst [optionControl, onOptionToggle, emitEvent] = useMenu(optionRef, 300);\n\tconst [learningControl, onLearningToggle] = useMenu(learningRef, 300);\n\tconst { \n\t\tselection, \n\t\tonSelection, \n\t\tonClickHighlight,\n\t\tonAddHighlight,\n\t\tonRemoveHighlight,\n\t\tonUpdateHighlight\n\t} = useHighlight(viewerRef, setIsContextMenu, bookStyle, bookOption.flow);\n\n\n\n\t/**\n\t * Change Epub book information\n\t * @param book Epub Book Info\n\t */\n\tconst onBookInfoChange = (book: Book) => dispatch(updateBook(book));\n\n  /**\n\t * Change Epub location\n\t * @param loc epubCFI or href\n\t */\n\tconst onLocationChange = (loc: string) => {\n\t\tif (!viewerRef.current) return;\n\t\tviewerRef.current.setLocation(loc);\n\t}\t\n\t\n\t/**\n\t * Move page\n\t * @param type Direction\n\t */\n\tconst onPageMove = (type: \"PREV\" | \"NEXT\") => {\n\t\tconst node = viewerRef.current;\n\t\tif (!node || !node.prevPage || !node.nextPage) return;\n\n\t\ttype === \"PREV\" && node.prevPage();\n\t\ttype === \"NEXT\" && node.nextPage();\n\t};\n\n\t/**\n\t * Set toc\n\t * @param toc Table of Epub contents\n\t */\n\tconst onTocChange = (toc: Toc[]) => dispatch(updateToc(toc));\n\n\t/** \n\t * Set Epub viewer styles\n\t * @param bokkStyle_ viewer style\n\t */\n\tconst onBookStyleChange = (bookStyle_: BookStyle) => setBookStyle(bookStyle_);\n\n\t/** \n\t * Set Epub viewer options\n\t * @param bookOption_ viewer option\n\t */\n\t const onBookOptionChange = (bookOption_: BookOption) => setBookOption(bookOption_);\n\n\t/**\n\t * Change current page\n\t * @param page Epub page\n\t */\n\tconst onPageChange = (page: Page) => dispatch(updateCurrentPage(page));\n\n\t/** \n\t * ContextMenu on \n\t * @param cfiRange CfiRange\n\t */\n\tconst onContextMenu = (cfiRange: string) => {\n\t\tconst result = onSelection(cfiRange);\n\t\tsetIsContextMenu(result);\n\t}\n\n\t/** ContextMenu off */\n\tconst onContextmMenuRemove = () => setIsContextMenu(false);\n\n\t\n\t\n  return (<>\n    <ViewerWrapper>\n      <Header \n\t\t\t\tonNavToggle={onNavToggle}\n\t\t\t\tonOptionToggle={onOptionToggle}\n\t\t\t\tonLearningToggle={onLearningToggle}\n\t\t\t/>\n\n      <Viewer \n\t\t\t\turl={url}\n\t\t\t\tviewerLayout={viewerLayout}\n\t\t\t\tviewerStyle={bookStyle}\n\t\t\t\tviewerOption={bookOption}\n\t\t\t\tonBookInfoChange={onBookInfoChange}\n\t\t\t\tonPageChange={onPageChange}\n\t\t\t\tonTocChange={onTocChange}\n\t\t\t\tonSelection={onContextMenu}\n\t\t\t\tloadingView={loadingView || <LoadingView />}\n\t\t\t\tref={viewerRef}\n\t\t\t/>\n      \n\t\t\t<Footer \n\t\t\t\ttitle={currentLocation.chapterName}\n\t\t\t\tnowPage={currentLocation.currentPage}\n\t\t\t\ttotalPage={currentLocation.totalPage}\n\t\t\t\tonPageMove={onPageMove}\n\t\t\t/>\n    </ViewerWrapper>\n\n    <Nav\n\t\t\tcontrol={navControl}\n\t\t\tonToggle={onNavToggle}\n\t\t\tonLocation={onLocationChange}\n\t\t\tref={navRef}\n\t\t/>\n    \n    <Option \n\t\t\tcontrol={optionControl}\n\t\t\tbookStyle={bookStyle}\n\t\t\tbookOption={bookOption}\n\t\t\tbookFlow={bookOption.flow}\n\t\t\tonToggle={onOptionToggle} \n\t\t\temitEvent={emitEvent}\n\t\t\tonBookStyleChange={onBookStyleChange}\n\t\t\tonBookOptionChange={onBookOptionChange}\n\t\t\tref={optionRef}\n\t\t/>\n\n\t\t<Learning \n\t\t\tcontrol={learningControl}\n\t\t\tonToggle={onLearningToggle}\n\t\t\tonClickHighlight={onClickHighlight}\n\t\t\temitEvent={emitEvent}\n\t\t\tviewerRef={viewerRef}\n\t\t\tref={learningRef}\n\t\t/>\n\n\t\t<ContextMenu\n\t\t\tactive={isContextMenu}\n\t\t\tviewerRef={viewerRef}\n\t\t\tselection={selection}\n\t\t\tonAddHighlight={onAddHighlight}\n\t\t\tonRemoveHighlight={onRemoveHighlight}\n\t\t\tonUpdateHighlight={onUpdateHighlight}\n\t\t\tonContextmMenuRemove={onContextmMenuRemove}\n\t\t/>\n\n\t\t<Snackbar />\n  </>);\n}\n\nconst ReaderWrapper = ({ url, loadingView }: Props) => {\n\treturn (\n\t\t<Provider store={store}>\n\t\t\t<Reader url={url} loadingView={loadingView} />\n\t\t</Provider>\n\t);\n}\n\ninterface Props {\n\turl: string;\n\tloadingView?: React.ReactNode;\n}\n\nexport default ReaderWrapper","import ReactDOM from 'react-dom';\nimport Reader from 'containers/Reader'\n\nconst EPUB_URL = \"/react-epub-viewer/files/Alices Adventures in Wonderland.epub\";\n\nReactDOM.render(<Reader url={EPUB_URL} />,  document.getElementById('root'));"],"sourceRoot":""}